{"version":3,"sources":["../../client/app/components/course-manage/course-manage.component.ts"],"names":[],"mappings":"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","file":"course-manage.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { CourseService } from \"../../services/course.service\";\r\nimport { Course } from \"../../models/course\";\r\nimport { SelectItem } from 'primeng/primeng';\r\ndeclare var swal: any;\r\ndeclare var moment: any;\r\n\r\n@Component({\r\n  selector: 'courseManage',\r\n  templateUrl: './app/components/course-manage/course-manage.component.html',\r\n  styleUrls: ['./app/components/course-manage/course-manage.component.css']\r\n})\r\n\r\n\r\nexport class CourseManageComponent implements OnInit {\r\n  courses: Course[];\r\n  error: any;\r\n  Campus: string[];\r\n  campusId: any;\r\n  professors: any[] = [];\r\n  courseType: string;\r\n  showForm: boolean = false;\r\n  //dropdown\r\n  campuses: SelectItem[] = [{ label: ' -- All --', value: '' }];\r\n  selectedCampusId: string;\r\n\r\n  constructor(private router: Router, private CourseService: CourseService) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    swal({\r\n      title: 'Loading...',\r\n      allowOutsideClick: false\r\n    });\r\n    swal.showLoading();\r\n    this.getInstructors();\r\n    this.getCampuses();\r\n    this.getCourses();\r\n  }\r\n\r\n  getCampuses() {\r\n    this.CourseService\r\n    .getCampuses()\r\n    .then(res => {\r\n      if ((res as any).result === \"error\") {\r\n        this.displayErrorAlert(res);\r\n      } else {\r\n        res.forEach((i) => {\r\n          this.campuses.push({\r\n            label: i.campusName,\r\n            value: i.campusId\r\n          });\r\n        });\r\n      }\r\n\r\n    });\r\n  }\r\n\r\n  getInstructors() {\r\n    this.CourseService\r\n    .getInstructors()\r\n    .then((result) => {\r\n      this.professors = result;\r\n    });\r\n  }\r\n\r\n  getCourses() {\r\n    this.CourseService\r\n      .getCourses()\r\n      .then(res => {\r\n        if ((res as any).result === \"error\") {\r\n          this.courses = null;\r\n          this.displayErrorAlert(res);\r\n        } else {\r\n          //format datetime\r\n          res.forEach((item) => {\r\n            item.courseStart = moment(item.courseStart).utcOffset(60).format('YYYY-MM-DD');\r\n            item.courseEnd = moment(item.courseEnd).utcOffset(60).format('YYYY-MM-DD');\r\n          });\r\n          this.courses = res;\r\n          swal.close();\r\n        }\r\n      })\r\n      .catch(error => this.error = error);\r\n  }\r\n\r\n  deleteAlert(course: Course, event: any) {\r\n    swal({\r\n      title: 'Delete course (' + course.courseName + ')?',\r\n      text: \"You won't be able to revert this!\",\r\n      type: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonColor: '#3085d6',\r\n      cancelButtonColor: '#d33',\r\n      confirmButtonText: 'Yes, delete it!'\r\n    }).then(isConfirm => {\r\n      if (isConfirm.dismiss === \"cancel\" || isConfirm.dismiss === \"overlay\") {\r\n        console.log(isConfirm.dismiss);\r\n      } else if (isConfirm) {\r\n        this.deleteCourse(course, event);\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n    });\r\n  }\r\n\r\n  deleteCourse(course: Course, event: any) {\r\n    event.stopPropagation();\r\n    this.CourseService\r\n      .delete(course)\r\n      .then(res => {\r\n        if ((res as any).result === \"error\") {\r\n          this.displayErrorAlert(res);\r\n        } else if ((res as any).result === \"success\") {\r\n          this.courses = this.courses.filter(h => h !== course);\r\n          swal(\r\n            'Deleted!',\r\n            'Course record has been deleted.',\r\n            'success'\r\n          );\r\n        } else {\r\n          swal(\r\n              'Error',\r\n              'Something went wrong, please try again.',\r\n              'error'\r\n          );\r\n        }\r\n      })\r\n      .catch(error => this.error = error);\r\n  }\r\n\r\n  gotoEdit(course: Course, event: any) {\r\n    this.router.navigate(['/course-edit', course.courseID]);\r\n  }\r\n\r\n  addCourse() {\r\n    this.router.navigate(['/course-edit', 'new']);\r\n  }\r\n\r\n  gotoStudentEnrollment(course: Course, event: any) {\r\n    this.router.navigate(['/student-enrollment', course.courseID, course.professorId, course.courseName]);\r\n  }\r\n\r\n  filterCampus(cam) {\r\n    this.campusId = this.Campus.indexOf(cam) + 1;\r\n  }\r\n\r\n  showCourseTypeForm() {\r\n    this.showForm = true;\r\n  }\r\n\r\n  addCourseType() {\r\n   if (this.courseType == null) {\r\n      swal(\r\n        'Invalid Input',\r\n        'Please enter a name for the new course type.',\r\n        'warning'\r\n      );\r\n    } else {\r\n      swal({\r\n        title: 'Saving...',\r\n        allowOutsideClick: false\r\n      });\r\n      swal.showLoading();\r\n      this.showForm = false;\r\n      this.CourseService\r\n        .addToCourseTypes(this.courseType)\r\n        .then(result => {\r\n          if ((result as any).result === 'error') {\r\n            this.displayErrorAlert(result);\r\n          } else if ((result as any).result === 'success')  {\r\n            swal.close();\r\n          } else {\r\n            swal(\r\n              'Error',\r\n              'Something went wrong while adding new course type.',\r\n              'error'\r\n            );\r\n          }\r\n        })\r\n        .catch(error => console.log(\"Error - Add new course type: \" + error));\r\n    }\r\n  }\r\n\r\n  closeMenu() {\r\n    this.showForm = false;\r\n  }\r\n\r\n  displayErrorAlert(error) {\r\n    if (error.title === \"Auth Error\") {\r\n      this.router.navigate(['/login']);\r\n      swal(\r\n        error.title,\r\n        error.msg,\r\n        'info'\r\n      );\r\n    } else {\r\n      swal(\r\n        error.title,\r\n        error.msg,\r\n        'error'\r\n      );\r\n    }\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n\r\n}\r\n"]}