{"version":3,"sources":["../../client/app/components/consent-form/consent-form.component.ts"],"names":[],"mappings":"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","file":"consent-form.component.js","sourcesContent":["import { Component, OnInit, Input } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { ConsentForm } from \"../../models/consentForm\";\r\nimport { ClientService } from \"../../services/client.service\";\r\nimport { AuthService } from '../../services/authentication.service';\r\ndeclare var swal: any;\r\n\r\n@Component({\r\n  selector: 'consentForm',\r\n  templateUrl: './app/components/consent-form/consent-form.component.html',\r\n  styleUrls: ['./app/components/consent-form/consent-form.component.css']\r\n})\r\n\r\n\r\nexport class ConsentFormComponent {\r\n  @Input() consentForm: ConsentForm;\r\n  error: any;\r\n  date: any;\r\n  clientName: string = '';\r\n  editConsentRequest: boolean = false;\r\n  editConsentPermission: boolean = false;\r\n  completeConsentForm: boolean;\r\n  currentUser: any;\r\n  otherChecked: boolean = false;\r\n  loading: boolean = true;\r\n\r\n  constructor(private clientService: ClientService, private router: Router, private authService: AuthService) {\r\n    this.currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n    var userID = this.currentUser.userID;\r\n    this.date = new Date();\r\n    this.consentForm = new ConsentForm();\r\n\r\n    if (this.currentUser.userType !== \"Client\") {\r\n      this.completeConsentForm = true;\r\n      this.loading = false;\r\n      swal(\r\n        'Read Only',\r\n        \"You are logged in as '\" + this.currentUser.userType + \"'. Only clients can submit this form.\",\r\n        'info'\r\n      );\r\n    } else {\r\n      this.clientService\r\n        .getClient(userID)\r\n        .then(result => {\r\n          this.clientName = result.client[0].firstName + \" \" + result.client[0].lastName;\r\n          this.editConsentRequest = result.client[0].editConsentRequest;\r\n          this.editConsentPermission = result.client[0].editConsentPermission;\r\n          this.completeConsentForm = result.client[0].consent;\r\n          if (!result.client[0].consent) {\r\n            this.clientService\r\n              .getConsentById()\r\n              .then(result => {\r\n                this.consentForm = result[0];\r\n                this.loading = false;\r\n                if (this.editConsentRequest && !this.editConsentPermission) {\r\n                  swal(\r\n                    'Edit Request Submitted',\r\n                    \"Check back once you have received an email.\",\r\n                    'info'\r\n                  );\r\n                } else if (this.editConsentPermission) {\r\n                  swal(\r\n                    'Edit Request Granted!',\r\n                    \"You can now edit this form.\",\r\n                    'info'\r\n                  );\r\n                } else {\r\n                  swal(\r\n                    'Read Only',\r\n                    \"You have already submitted this form. Select 'Request to Edit' if you would like to make changes.\",\r\n                    'info'\r\n                  );\r\n                }\r\n              })\r\n              .catch(err => {\r\n                console.log(err);\r\n              });\r\n            if (this.consentForm.other == null || this.consentForm.other === '') {\r\n              this.otherChecked = false;\r\n            } else {\r\n              this.otherChecked = true;\r\n            }\r\n          } else {\r\n            this.consentForm.ontarioWorks = false;\r\n            this.consentForm.ontarioDisabilityProgram = false;\r\n            this.consentForm.employmentInsurance = false;\r\n            this.consentForm.employmentServices = false;\r\n            this.consentForm.wsib = false;\r\n            this.loading = false;\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    }\r\n  }\r\n\r\n  saveConsent() {\r\n    // if (!this.consentForm.allowDetailedMessage) {\r\n    //   if (!this.consentForm.alternateNumber) {\r\n    //     swal(\r\n    //         'Whoops!',\r\n    //         'Please enter an alternate phone number.',\r\n    //         'warning'\r\n    //     );\r\n    //   } else {\r\n    //     if (!this.consentForm.contactName || !this.consentForm.contactNum ) {\r\n    //       swal(\r\n    //           'Whoops!',\r\n    //           'Please fill out all form fields.',\r\n    //           'warning'\r\n    //       );\r\n    //     } else {\r\n    //       this.consentForm.date = this.date;\r\n    //       this.clientService\r\n    //           .saveConsent(this.consentForm)\r\n    //           .then(client => {\r\n    //               this.router.navigate(['/dashboard']);\r\n    //           })\r\n    //           .catch(error => this.error = error);\r\n    //     }\r\n    //   }\r\n    // } else {\r\n    //   if (!this.consentForm.contactName || !this.consentForm.contactNum ) {\r\n    //     swal(\r\n    //         'Whoops!',\r\n    //         'Please fill out all form fields.',\r\n    //         'warning'\r\n    //     );\r\n    //   } else {\r\n    //     this.consentForm.date = this.date;\r\n    //     this.clientService\r\n    //         .saveConsent(this.consentForm)\r\n    //         .then(client => {\r\n    //             this.router.navigate(['/dashboard']);\r\n    //         })\r\n    //         .catch(error => this.error = error);\r\n    //   }\r\n    // }\r\n    this.consentForm.date = this.date;\r\n    this.clientService\r\n      .saveConsent(this.consentForm)\r\n      .then(client => {\r\n        this.router.navigate(['/dashboard']);\r\n      })\r\n      .catch(error => this.error = error);\r\n  }\r\n\r\n  requestEdit() {\r\n    this.clientService\r\n      .requestEditConsent()\r\n      .then(result => {\r\n        if (result.status === 'success') {\r\n          swal(\r\n            'Request Sent!',\r\n            'You will receive an email once your request has been accepted.',\r\n            'info'\r\n          );\r\n          this.router.navigate(['/dashboard']);\r\n        } else {\r\n          swal(\r\n            'Something went wrong...',\r\n            'Please try again. If the issue persists contact support.',\r\n            'error'\r\n          );\r\n        }\r\n      })\r\n      .catch(error => this.error = error);\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n\r\n}\r\n"]}