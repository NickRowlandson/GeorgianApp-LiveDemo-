{"version":3,"sources":["../../client/app/components/consent-form/consent-form.component.ts"],"names":[],"mappings":"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","file":"consent-form.component.js","sourcesContent":["import { Component, OnInit, Input } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { ConsentForm } from \"../../models/consentForm\";\r\nimport { ClientService } from \"../../services/client.service\";\r\nimport { StudentService } from \"../../services/student.service\";\r\nimport { AuthService } from '../../services/authentication.service';\r\ndeclare var swal: any;\r\n\r\n@Component({\r\n  selector: 'consentForm',\r\n  templateUrl: './app/components/consent-form/consent-form.component.html',\r\n  styleUrls: ['./app/components/consent-form/consent-form.component.css']\r\n})\r\n\r\n\r\nexport class ConsentFormComponent {\r\n  @Input() consentForm: ConsentForm;\r\n  error: any;\r\n  date: any;\r\n  clientName: string = '';\r\n  editConsentRequest: boolean = false;\r\n  editConsentPermission: boolean = false;\r\n  completeConsentForm: boolean;\r\n  currentUser: any;\r\n  otherChecked: boolean = false;\r\n  loading: boolean = true;\r\n\r\n  constructor(private clientService: ClientService, private studentService: StudentService, private router: Router, private authService: AuthService) {\r\n    this.currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n    var userID = this.currentUser.userID;\r\n    this.date = new Date();\r\n    this.consentForm = new ConsentForm();\r\n\r\n    if (this.currentUser.userType === \"Instructor\" || this.currentUser.userType === \"Staff\" || this.currentUser.userType === \"Admin\") {\r\n      this.completeConsentForm = true;\r\n      this.loading = false;\r\n      swal(\r\n        'Read Only',\r\n        \"You are logged in as '\" + this.currentUser.userType + \"'. Only clients can submit this form.\",\r\n        'info'\r\n      );\r\n    }\r\n\r\n    if (this.currentUser.userType === \"Client\") {\r\n      this.clientService\r\n        .getClient(userID)\r\n        .then(result => {\r\n          console.log(result);\r\n          this.clientName = result[0].firstName + \" \" + result[0].lastName;\r\n          this.editConsentRequest = result[0].editConsentRequest;\r\n          this.editConsentPermission = result[0].editConsentPermission;\r\n          this.completeConsentForm = result[0].consent;\r\n          if (!result[0].consent) {\r\n            this.clientService\r\n              .getConsentById()\r\n              .then(result => {\r\n                this.consentForm = result[0];\r\n                this.loading = false;\r\n                if (this.editConsentRequest && !this.editConsentPermission) {\r\n                  swal(\r\n                    'Edit Request Submitted',\r\n                    \"Check back once you have received an email.\",\r\n                    'info'\r\n                  );\r\n                } else if (this.editConsentPermission) {\r\n                  swal(\r\n                    'Edit Request Granted!',\r\n                    \"You can now edit this form.\",\r\n                    'info'\r\n                  );\r\n                } else {\r\n                  swal(\r\n                    'Read Only',\r\n                    \"You have already submitted this form. Select 'Request to Edit' if you would like to make changes.\",\r\n                    'info'\r\n                  );\r\n                }\r\n              })\r\n              .catch(err => {\r\n                console.log(err);\r\n              });\r\n            if (this.consentForm.other == null || this.consentForm.other === '') {\r\n              this.otherChecked = false;\r\n            } else {\r\n              this.otherChecked = true;\r\n            }\r\n          } else {\r\n            this.consentForm.ontarioWorks = false;\r\n            this.consentForm.ontarioDisabilityProgram = false;\r\n            this.consentForm.employmentInsurance = false;\r\n            this.consentForm.employmentServices = false;\r\n            this.consentForm.wsib = false;\r\n            this.loading = false;\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    }\r\n\r\n    if (this.currentUser.userType === \"Student\") {\r\n      this.studentService\r\n        .getStudent(userID)\r\n        .then(result => {\r\n          console.log(result);\r\n          this.clientName = result.firstName + \" \" + result.lastName;\r\n          this.editConsentRequest = result.editConsentRequest;\r\n          this.editConsentPermission = result.editConsentPermission;\r\n          this.completeConsentForm = result.consent;\r\n          if (!result.consent) {\r\n            this.clientService\r\n              .getConsentById()\r\n              .then(result => {\r\n                this.consentForm = result[0];\r\n                this.loading = false;\r\n                if (this.editConsentRequest && !this.editConsentPermission) {\r\n                  swal(\r\n                    'Edit Request Submitted',\r\n                    \"Check back once you have received an email.\",\r\n                    'info'\r\n                  );\r\n                } else if (this.editConsentPermission) {\r\n                  swal(\r\n                    'Edit Request Granted!',\r\n                    \"You can now edit this form.\",\r\n                    'info'\r\n                  );\r\n                } else {\r\n                  swal(\r\n                    'Read Only',\r\n                    \"You have already submitted this form. Select 'Request to Edit' if you would like to make changes.\",\r\n                    'info'\r\n                  );\r\n                }\r\n              })\r\n              .catch(err => {\r\n                console.log(err);\r\n              });\r\n            if (this.consentForm.other == null || this.consentForm.other === '') {\r\n              this.otherChecked = false;\r\n            } else {\r\n              this.otherChecked = true;\r\n            }\r\n          } else {\r\n            this.consentForm.ontarioWorks = false;\r\n            this.consentForm.ontarioDisabilityProgram = false;\r\n            this.consentForm.employmentInsurance = false;\r\n            this.consentForm.employmentServices = false;\r\n            this.consentForm.wsib = false;\r\n            this.loading = false;\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    }\r\n  }\r\n\r\n  saveConsent() {\r\n    // if (!this.consentForm.allowDetailedMessage) {\r\n    //   if (!this.consentForm.alternateNumber) {\r\n    //     swal(\r\n    //         'Whoops!',\r\n    //         'Please enter an alternate phone number.',\r\n    //         'warning'\r\n    //     );\r\n    //   } else {\r\n    //     if (!this.consentForm.contactName || !this.consentForm.contactNum ) {\r\n    //       swal(\r\n    //           'Whoops!',\r\n    //           'Please fill out all form fields.',\r\n    //           'warning'\r\n    //       );\r\n    //     } else {\r\n    //       this.consentForm.date = this.date;\r\n    //       this.clientService\r\n    //           .saveConsent(this.consentForm)\r\n    //           .then(client => {\r\n    //               this.router.navigate(['/dashboard']);\r\n    //           })\r\n    //           .catch(error => this.error = error);\r\n    //     }\r\n    //   }\r\n    // } else {\r\n    //   if (!this.consentForm.contactName || !this.consentForm.contactNum ) {\r\n    //     swal(\r\n    //         'Whoops!',\r\n    //         'Please fill out all form fields.',\r\n    //         'warning'\r\n    //     );\r\n    //   } else {\r\n    //     this.consentForm.date = this.date;\r\n    //     this.clientService\r\n    //         .saveConsent(this.consentForm)\r\n    //         .then(client => {\r\n    //             this.router.navigate(['/dashboard']);\r\n    //         })\r\n    //         .catch(error => this.error = error);\r\n    //   }\r\n    // }\r\n    this.consentForm.date = this.date;\r\n    this.clientService\r\n      .saveConsent(this.consentForm)\r\n      .then(client => {\r\n        this.router.navigate(['/dashboard']);\r\n      })\r\n      .catch(error => this.error = error);\r\n  }\r\n\r\n  requestEdit() {\r\n    if (this.currentUser.userType === \"Client\") {\r\n      this.clientService\r\n        .requestEditConsent()\r\n        .then(result => {\r\n          if ((result as any).status === 'success') {\r\n            swal(\r\n              'Request Sent!',\r\n              'You will receive an email once your request has been accepted.',\r\n              'info'\r\n            );\r\n            this.router.navigate(['/dashboard']);\r\n          } else {\r\n            swal(\r\n              'Something went wrong...',\r\n              'Please try again. If the issue persists contact support.',\r\n              'error'\r\n            );\r\n          }\r\n        })\r\n        .catch(error => this.error = error);\r\n    } else if (this.currentUser.userType === \"Student\") {\r\n      this.studentService\r\n        .requestEditConsent()\r\n        .then(result => {\r\n          if ((result as any).status === 'success') {\r\n            swal(\r\n              'Request Sent!',\r\n              'You will receive an email once your request has been accepted.',\r\n              'info'\r\n            );\r\n            this.router.navigate(['/dashboard']);\r\n          } else {\r\n            swal(\r\n              'Something went wrong...',\r\n              'Please try again. If the issue persists contact support.',\r\n              'error'\r\n            );\r\n          }\r\n        })\r\n        .catch(error => this.error = error);\r\n    }\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n\r\n}\r\n"]}