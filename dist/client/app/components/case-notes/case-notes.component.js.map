{"version":3,"sources":["../../client/app/components/case-notes/case-notes.component.ts"],"names":[],"mappings":"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","file":"case-notes.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { StudentService } from \"../../services/student.service\";\r\nimport { StaffService } from \"../../services/staff.service\";\r\nimport { Student } from \"../../models/student\";\r\nimport { User } from \"../../models/user\";\r\ndeclare var swal: any;\r\n\r\n@Component({\r\n  selector: 'caseNotes',\r\n  templateUrl: './app/components/case-notes/case-notes.component.html',\r\n  styleUrls: ['./app/components/case-notes/case-notes.component.css']\r\n})\r\n\r\nexport class CaseNotesComponent implements OnInit {\r\n  data: any[];\r\n  notes: any[];\r\n  users: User[];\r\n  notesView: Student;\r\n  note: any;\r\n  newNote: boolean;\r\n  status: any;\r\n  error: any;\r\n\r\n  constructor(private router: Router, private studentService: StudentService, private staffService: StaffService) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    swal({\r\n      title: 'Loading...',\r\n      allowOutsideClick: false\r\n    });\r\n    swal.showLoading();\r\n    this.getStudents();\r\n  }\r\n\r\n  getStudents() {\r\n    this.studentService\r\n      .getStudents()\r\n      .then(students => {\r\n        if ((students as any).result === 'error') {\r\n          this.data = null;\r\n          this.displayErrorAlert(students);\r\n        } else {\r\n          this.data = students;\r\n          for (let student of this.data) {\r\n            student.fullName = student.firstName + \" \" + student.lastName;\r\n          }\r\n          this.getUsers();\r\n        }\r\n      })\r\n      .catch(error => this.error = error);\r\n  }\r\n\r\n  getUsers() {\r\n    this.staffService\r\n    .getUsers()\r\n    .then(users => {\r\n      if ((users as any).result === 'error') {\r\n        this.users = null;\r\n        this.displayErrorAlert(users);\r\n      } else {\r\n        this.users = users;\r\n        swal.close();\r\n      }\r\n    })\r\n    .catch(error => this.error = error);\r\n  }\r\n\r\n  saveNote(userID) {\r\n    if (this.note == null) {\r\n      swal(\r\n        'Empty Input',\r\n        'Type something in the text area to save new note.',\r\n        'warning'\r\n      );\r\n    } else {\r\n      this.studentService\r\n          .saveNewNote(this.note, userID)\r\n          .then(note => {\r\n            if ((note as any).result === 'error') {\r\n              this.displayErrorAlert(note);\r\n            } else if ((note as any).result === 'success') {\r\n              this.note = '';\r\n              this.showNotes(userID);\r\n            } else {\r\n              swal(\r\n                'Error',\r\n                'Something went wrong, please try again.',\r\n                'error'\r\n              );\r\n            }\r\n          })\r\n          .catch(error => this.error = error); // TODO: Display error message\r\n\r\n      this.newNote = false;\r\n    }\r\n  }\r\n\r\n  showCaseNotes(student: Student) {\r\n    this.notesView = student;\r\n    this.showNotes(student.userID);\r\n  }\r\n\r\n  showNotes(userID) {\r\n    this.studentService\r\n        .getNotes(userID)\r\n        .then(notes => {\r\n          if ((notes as any).result === 'error') {\r\n            this.displayErrorAlert(notes);\r\n          } else {\r\n            this.notes = notes;\r\n            for (let notes of this.notes) {\r\n              var facultyUser = this.users.filter(x => x.userID === notes.facultyID);\r\n              if (facultyUser[0] != null) {\r\n                notes.facultyUser = facultyUser[0].firstName + \" \" + facultyUser[0].lastName;\r\n              } else {\r\n                notes.facultyUser = 'Automated Message';\r\n              }\r\n            }\r\n          }\r\n        })\r\n        .catch(error => console.log(error));\r\n  }\r\n\r\n  deleteNote(noteID) {\r\n      event.stopPropagation();\r\n      this.studentService\r\n          .deleteNote(noteID)\r\n          .then(result => {\r\n            if ((result as any).result === 'error') {\r\n              this.displayErrorAlert(result);\r\n            } else if ((result as any).result === 'success') {\r\n              this.notes = this.notes.filter(h => h.caseNoteID !== noteID);\r\n            } else {\r\n              swal(\r\n                'Error',\r\n                'Something went wrong, please try again.',\r\n                'error'\r\n              );\r\n            }\r\n          })\r\n          .catch(error => this.error = error);\r\n  }\r\n\r\n  deleteAlert(noteID) {\r\n      swal({\r\n          title: 'Delete note?',\r\n          text: \"You won't be able to revert this!\",\r\n          type: 'warning',\r\n          showCancelButton: true,\r\n          confirmButtonColor: '#3085d6',\r\n          cancelButtonColor: '#d33',\r\n          confirmButtonText: 'Yes, delete it!'\r\n      }).then(isConfirm => {\r\n        if (isConfirm.dismiss === \"cancel\" || isConfirm.dismiss === \"overlay\") {\r\n          console.log(isConfirm.dismiss);\r\n        } else if (isConfirm) {\r\n          this.deleteNote(noteID);\r\n        }\r\n      }).catch(error => {\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  displayErrorAlert(error) {\r\n    swal(\r\n      error.title,\r\n      error.msg,\r\n      'error'\r\n    );\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n}\r\n"]}