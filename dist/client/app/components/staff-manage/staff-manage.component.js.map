{"version":3,"sources":["../../client/app/components/staff-manage/staff-manage.component.ts"],"names":[],"mappings":"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","file":"staff-manage.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { StaffService } from \"../../services/staff.service\";\r\nimport { User } from \"../../models/user\";\r\nimport { Router } from '@angular/router';\r\ndeclare var swal: any;\r\n\r\n\r\n@Component({\r\n    selector: 'staff-manage',\r\n    templateUrl: './app/components/staff-manage/staff-manage.component.html',\r\n    styleUrls: ['./app/components/staff-manage/staff-manage.component.css']\r\n})\r\n\r\n\r\nexport class StaffManageComponent implements OnInit {\r\n    users: User[];\r\n    usersBackup: User[];\r\n    error: any;\r\n    usersLength: any;\r\n    adminNumber: any;\r\n    staffNumber: any;\r\n    instructorNumber: any;\r\n\r\n    constructor(private router: Router, private staffService: StaffService) {\r\n\r\n    }\r\n\r\n    ngOnInit() {\r\n      swal({\r\n        title: 'Loading...',\r\n        allowOutsideClick: false\r\n      });\r\n      swal.showLoading();\r\n      this.getUsers();\r\n    }\r\n\r\n    getUsers() {\r\n        this.staffService\r\n          .getUsers()\r\n          .then(users => {\r\n            if ((users as any).result === \"error\") {\r\n              this.users = null;\r\n              this.displayErrorAlert((users as any));\r\n            } else {\r\n              this.users = users;\r\n              for (let user of this.users) {\r\n                user.fullName = user.firstName + \" \" + user.lastName;\r\n              }\r\n              this.usersBackup = this.users;\r\n              this.usersLength = users.length;\r\n              this.updateStats();\r\n            }\r\n          })\r\n          .catch(error => this.error = error);\r\n    }\r\n\r\n    gotoEdit(user: User, event: any) {\r\n        this.router.navigate(['/staff-details', user.userID]);\r\n    }\r\n\r\n    addUser() {\r\n        this.router.navigate(['/staff-details', 'new']);\r\n    }\r\n\r\n    deleteAlert(user: User, event: any) {\r\n        swal({\r\n            title: 'Delete ' + user.firstName + ' ' + user.lastName + '?',\r\n            text: \"You won't be able to revert this!\",\r\n            type: 'warning',\r\n            showCancelButton: true,\r\n            confirmButtonColor: '#3085d6',\r\n            cancelButtonColor: '#d33',\r\n            confirmButtonText: 'Yes, delete!'\r\n        }).then(isConfirm => {\r\n          if (isConfirm.dismiss === \"cancel\" || isConfirm.dismiss === \"overlay\") {\r\n            console.log(isConfirm.dismiss);\r\n          } else if (isConfirm) {\r\n            this.deleteUser(user, event);\r\n          }\r\n        }).catch(error => {\r\n          console.log(error);\r\n        });\r\n    }\r\n\r\n    deleteUser(user: User, event: any) {\r\n        event.stopPropagation();\r\n        this.staffService\r\n          .delete(user)\r\n          .then(res => {\r\n            console.log(res);\r\n            if ((res as any).result === \"error\") {\r\n              this.displayErrorAlert((res as any));\r\n            } else if ((res as any).result === \"success\") {\r\n              this.users = this.users.filter(h => h !== user);\r\n              this.usersBackup = this.users;\r\n              this.usersLength = this.users.length;\r\n              this.updateStats();\r\n              swal(\r\n                  'Deleted!',\r\n                  'User has been deleted.',\r\n                  'success'\r\n              );\r\n            } else {\r\n              swal(\r\n                  'Error',\r\n                  'Something went wrong, please try again.',\r\n                  'error'\r\n              );\r\n            }\r\n          })\r\n          .catch(error => this.error = error);\r\n    }\r\n\r\n    updateStats() {\r\n      this.adminNumber = this.users.filter(x => x.userType.indexOf(\"Admin\") !== -1);\r\n      this.adminNumber = this.adminNumber.length;\r\n      this.staffNumber = this.users.filter(x => x.userType.indexOf(\"Staff\") !== -1);\r\n      this.staffNumber = this.staffNumber.length;\r\n      this.instructorNumber = this.users.filter(x => x.userType.indexOf(\"Instructor\") !== -1);\r\n      this.instructorNumber = this.instructorNumber.length;\r\n      swal.close();\r\n    }\r\n\r\n    filterStaff(userType) {\r\n      this.users = this.usersBackup;\r\n      if (userType === 'total') {\r\n        this.users = this.usersBackup;\r\n      } else {\r\n        this.users = this.users.filter(x => x.userType.indexOf(userType) !== -1);\r\n      }\r\n    }\r\n\r\n    displayErrorAlert(error) {\r\n      swal(\r\n          error.title,\r\n          error.msg,\r\n          'error'\r\n      );\r\n    }\r\n\r\n    goBack() {\r\n        window.history.back();\r\n    }\r\n}\r\n"]}