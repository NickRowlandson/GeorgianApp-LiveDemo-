{"version":3,"sources":["../../client/app/components/attendance-list/attendance-list.component.ts"],"names":[],"mappings":"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","file":"attendance-list.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { CourseService } from \"../../services/course.service\";\r\nimport { Course } from \"../../models/course\";\r\nimport { Student } from \"../../models/Student\";\r\nimport { StudentService } from \"../../services/student.service\";\r\ndeclare var swal: any;\r\n\r\n@Component({\r\n    selector: 'attendanceList',\r\n    templateUrl: './app/components/attendance-list/attendance-list.component.html',\r\n    styleUrls: ['./app/components/attendance-list/attendance-list.component.css']\r\n})\r\n\r\nexport class AttendanceListComponent implements OnInit {\r\n    data: any;\r\n    date: any;\r\n    courseID: any;\r\n    attendanceView: boolean = false;\r\n    loading: boolean = false;\r\n    attendanceCourse: any;\r\n    attendanceStudents: any;\r\n    timetables: any;\r\n    attendance: any;\r\n    absentStudents = [];\r\n    attendanceDates: any[] = [];\r\n\r\n    constructor(private router: Router, private CourseService: CourseService, private StudentService: StudentService) {\r\n      this.date = new Date();\r\n    }\r\n\r\n    ngOnInit() {\r\n      var currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n      var userID = currentUser.userID;\r\n      this.getCourses(userID);\r\n    }\r\n\r\n    getCourses(instructorID) {\r\n        this.CourseService\r\n            .getInstructorCourses(instructorID)\r\n            .then(result => {\r\n                var isEmpty = (result || []).length === 0;\r\n                if (isEmpty) {\r\n                    console.log(result);\r\n                    this.data = null;\r\n                } else {\r\n                    this.data = result;\r\n                }\r\n            })\r\n            .catch(error => console.log(error));\r\n    }\r\n\r\n    doAttendance(course: Course) {\r\n      this.loading = true;\r\n      this.courseID = course.courseID;\r\n      this.StudentService\r\n          .getTimetablesByCourseId(course.courseID)\r\n          .then(result => {\r\n              var isEmpty = (result || []).length === 0;\r\n              if (isEmpty) {\r\n                  this.timetables = null;\r\n                  this.attendanceStudents = null;\r\n                  this.loading = false;\r\n              } else {\r\n                  this.timetables = result;\r\n                  this.getStudentsById(this.timetables);\r\n              }\r\n          })\r\n          .catch(error => console.log(error));\r\n\r\n      this.attendanceCourse = course;\r\n      var array = this.attendanceCourse.classTimeStr.split(',');\r\n      for (let item of array) {\r\n        var date = item.split(' ');\r\n        var day = date[0];\r\n        var time = date[1];\r\n        var startTime = time.split('-')[0];\r\n        var endTime = time.split('-')[1];\r\n        this.attendanceDates.push(date);\r\n      }\r\n      this.attendanceView = true;\r\n      console.log(this.attendanceDates);\r\n    }\r\n\r\n    getStudentsById(timetables) {\r\n      this.StudentService\r\n          .getStudentsById(timetables)\r\n          .then(result => {\r\n              var isEmpty = (result || []).length === 0;\r\n              if (isEmpty) {\r\n                  this.attendanceStudents = null;\r\n              } else {\r\n                  this.attendanceStudents = result;\r\n                  for (let student of this.attendanceStudents) {\r\n                    student.fullName = student.firstName + \" \" + student.lastName;\r\n                  }\r\n                  this.loading = false;\r\n              }\r\n          })\r\n          .catch(error => console.log(error));\r\n    }\r\n\r\n    // markAbsent(student: Student) {\r\n    //   if (student.absent) {\r\n    //     student.absent = false;\r\n    //     var index = this.absentStudents.indexOf(student.studentID);\r\n    //     this.absentStudents.splice(index, 1);\r\n    //   } else {\r\n    //     student.absent = true;\r\n    //     this.absentStudents.push(student.studentID);\r\n    //   }\r\n    //   console.log(this.absentStudents);\r\n    // }\r\n\r\n    submitAttendance() {\r\n      var count = 0;\r\n      for (let student of this.attendanceStudents) {\r\n        if (student.attendanceValue) {\r\n          count++;\r\n        }\r\n      }\r\n\r\n      if (!this.attendanceCourse.attendanceDate) {\r\n        console.log(this.attendanceCourse);\r\n        swal(\r\n            'Attendance Incomplete',\r\n            'Please enter an attendance date',\r\n            'warning'\r\n        );\r\n      } else if (count === this.attendanceStudents.length && this.attendanceCourse.attendanceDate) {\r\n        swal({\r\n            title: 'Submit Attendance?',\r\n            text: \"You won't be able to revert this!\",\r\n            type: 'info',\r\n            showCancelButton: true,\r\n            confirmButtonColor: '#3085d6',\r\n            cancelButtonColor: '#d33',\r\n            confirmButtonText: 'Yes, submit!'\r\n        }).then(isConfirm => {\r\n          if (isConfirm) {\r\n            this.attendance = {\r\n              students: this.attendanceStudents,\r\n              courseID: this.courseID,\r\n              date: this.attendanceCourse.attendanceDate\r\n            };\r\n            this.StudentService\r\n                .insertAttendance(this.attendance)\r\n                .then(result => {\r\n                  swal(\r\n                      'Attendance submitted!',\r\n                      '',\r\n                      'success'\r\n                  );\r\n                  this.attendanceView = false;\r\n                })\r\n                .catch(error => console.log(error));\r\n          }\r\n        }).catch(error => {\r\n          //console.log(\"Canceled\");\r\n        });\r\n      } else {\r\n        swal(\r\n            'Attendance Incomplete',\r\n            'Please enter attendance for all students',\r\n            'warning'\r\n        );\r\n      }\r\n\r\n    }\r\n\r\n    goBack() {\r\n        window.history.back();\r\n    }\r\n}\r\n"]}