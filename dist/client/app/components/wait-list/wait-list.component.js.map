{"version":3,"sources":["../../client/app/components/wait-list/wait-list.component.ts"],"names":[],"mappings":"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","file":"wait-list.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { Course } from \"../../models/course\";\r\nimport { Student } from \"../../models/student\";\r\nimport { Client } from \"../../models/client\";\r\nimport { CourseService } from \"../../services/course.service\";\r\nimport { StudentService } from \"../../services/student.service\";\r\nimport { ClientService } from \"../../services/client.service\";\r\nimport { StaffService } from \"../../services/staff.service\";\r\ndeclare var swal: any;\r\ndeclare var moment;\r\n\r\n@Component({\r\n  selector: 'waitList',\r\n  templateUrl: './app/components/wait-list/wait-list.component.html',\r\n  styleUrls: ['./app/components/wait-list/wait-list.component.css']\r\n})\r\n\r\nexport class WaitListComponent implements OnInit {\r\n  data: any;\r\n  students: Student[];\r\n  clients: Client[];\r\n  users: any = [];\r\n  courseTypes: any[];\r\n  waitList: any[];\r\n  timetables: any[];\r\n  courseWaitList: any[];\r\n  usersWaiting:any = [];\r\n  viewingCourse: Course[];\r\n  selectedCourseType: Course[];\r\n  selectedUser: any[];\r\n  showForm: boolean = false;\r\n\r\n  constructor(private router: Router, private CourseService: CourseService, private StudentService: StudentService, private ClientService: ClientService, private StaffService: StaffService) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    swal({\r\n      title: 'Loading...',\r\n      allowOutsideClick: false\r\n    });\r\n    swal.showLoading();\r\n    this.getStudents();\r\n    //this.getTimetables();\r\n  }\r\n\r\n  getStudents() {\r\n    this.StudentService\r\n      .getStudents()\r\n      .then(students => {\r\n        if ((students as any).result === 'error') {\r\n          this.students = null;\r\n          this.displayErrorAlert(students);\r\n        } else {\r\n          this.students = students;\r\n          for (let student of this.students) {\r\n            student.fullName = student.firstName + \" \" + student.lastName;\r\n            this.users.push(student);\r\n          }\r\n          this.getClients();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get students: \" + error));\r\n  }\r\n\r\n  getClients() {\r\n    this.ClientService\r\n      .getClients()\r\n      .then(clients => {\r\n        if ((clients as any).result === 'error') {\r\n          this.clients = null;\r\n          this.displayErrorAlert(clients);\r\n        } else {\r\n          this.clients = (clients as any).clients;\r\n          for (let client of this.clients) {\r\n            client.fullName = client.firstName + \" \" + client.lastName;\r\n            this.users.push(client);\r\n          }\r\n          this.getCourses();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get clients: \" + error));\r\n  }\r\n\r\n  getCourses() {\r\n    this.CourseService\r\n      .getCourseTypes()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.courseTypes = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.courseTypes = result;\r\n          this.getWaitList();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get courses: \" + error));\r\n  }\r\n\r\n  getWaitList() {\r\n    this.usersWaiting = [];\r\n    this.CourseService\r\n      .getWaitList()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.waitList = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.waitList = result;\r\n          for (let item of this.waitList) {\r\n             var user = this.users.filter(x => x.userID === item.userID);\r\n             //student[0].fullName = student[0].firstName + \" \" + student[0].lastName;\r\n             // student[0].courseID = course[0].courseID;\r\n             // student[0].professorId = course[0].professorId;\r\n             user[0].courseName = item.courseType;\r\n             var userRecord = {\r\n               fullName: user[0].fullName,\r\n               courseType: item.courseType,\r\n               date: item.date\r\n             };\r\n             this.usersWaiting.push(userRecord);\r\n          }\r\n          this.getTimetables();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get wait list: \" + error));\r\n  }\r\n\r\n  getTimetables() {\r\n    this.StudentService\r\n      .getTimetables()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.timetables = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.timetables = result;\r\n          swal.close();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get timetables: \" + error));\r\n  }\r\n\r\n  showWaitListForm() {\r\n    this.showForm = true;\r\n  }\r\n\r\n  addStudentToWaitList() {\r\n    var CurrentDate = moment().format();\r\n   if (this.selectedUser == null || this.selectedCourseType == null) {\r\n      swal(\r\n        'Invalid Input',\r\n        'Please select both a student and a course.',\r\n        'warning'\r\n      );\r\n    } else {\r\n      swal({\r\n        title: 'Saving...',\r\n        allowOutsideClick: false\r\n      });\r\n      swal.showLoading();\r\n      this.courseWaitList = null;\r\n      this.showForm = false;\r\n      this.CourseService\r\n        .addToWaitList(this.selectedUser, this.selectedCourseType, CurrentDate)\r\n        .then(result => {\r\n          if ((result as any).result === 'error') {\r\n            this.displayErrorAlert(result);\r\n          } else if ((result as any).result === 'success')  {\r\n            this.getWaitList();\r\n            swal.close();\r\n          } else {\r\n            swal(\r\n              'Error',\r\n              'Something went wrong while adding student to wait list.',\r\n              'error'\r\n            );\r\n          }\r\n        })\r\n        .catch(error => console.log(\"Error - Add student to wait list: \" + error));\r\n    }\r\n  }\r\n\r\n  closeMenu() {\r\n    this.showForm = false;\r\n  }\r\n\r\n  gotoStudentEnrollment(course, data, event: any) {\r\n    if (course == null) {\r\n      course = this.courses.filter(x => x.courseName === data.courseName);\r\n      course = course[0];\r\n    }\r\n    this.router.navigate(['/student-enrollment', course.courseID, course.professorId, course.courseName]);\r\n  }\r\n\r\n  viewCourseWaitList(data) {\r\n    this.viewingCourse = data;\r\n    this.usersWaiting = [];\r\n    this.courseWaitList = this.waitList.filter(x => x.courseType === data.courseType);\r\n    for (let item of this.courseWaitList) {\r\n       var user = this.users.filter(x => x.userID === item.userID);\r\n       user[0].fullName = user[0].firstName + \" \" + user[0].lastName;\r\n       var userRecord = {\r\n         fullName: user[0].fullName,\r\n         date: item.date\r\n       };\r\n\r\n       this.usersWaiting.push(userRecord);\r\n    }\r\n  }\r\n\r\n  onPrint() {\r\n    (window as any).print();\r\n  }\r\n\r\n  displayErrorAlert(error) {\r\n    swal(\r\n      error.title,\r\n      error.msg,\r\n      'error'\r\n    );\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n}\r\n"]}