{"version":3,"sources":["../../client/app/components/wait-list/wait-list.component.ts"],"names":[],"mappings":"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","file":"wait-list.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { Course } from \"../../models/course\";\r\nimport { Student } from \"../../models/student\";\r\nimport { Client } from \"../../models/client\";\r\nimport { CourseService } from \"../../services/course.service\";\r\nimport { StudentService } from \"../../services/student.service\";\r\nimport { ClientService } from \"../../services/client.service\";\r\nimport { StaffService } from \"../../services/staff.service\";\r\ndeclare var swal: any;\r\ndeclare var moment;\r\n\r\n@Component({\r\n  selector: 'waitList',\r\n  templateUrl: './app/components/wait-list/wait-list.component.html',\r\n  styleUrls: ['./app/components/wait-list/wait-list.component.css']\r\n})\r\n\r\nexport class WaitListComponent implements OnInit {\r\n  data: any;\r\n  students: Student[];\r\n  clients: Client[];\r\n  users: any = [];\r\n  courseTypes: any[];\r\n  waitList: any[];\r\n  timetables: any[];\r\n  courseWaitList: any[];\r\n  usersWaiting:any = [];\r\n  viewingCourse: Course[];\r\n  selectedCourseType: Course[];\r\n  selectedUser: any[];\r\n  showForm: boolean = false;\r\n\r\n  constructor(private router: Router, private CourseService: CourseService, private StudentService: StudentService, private ClientService: ClientService, private StaffService: StaffService) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    swal({\r\n      title: 'Loading...',\r\n      allowOutsideClick: false\r\n    });\r\n    swal.showLoading();\r\n    this.getStudents();\r\n    //this.getTimetables();\r\n  }\r\n\r\n  getStudents() {\r\n    this.StudentService\r\n      .getStudents()\r\n      .then(students => {\r\n        if ((students as any).result === 'error') {\r\n          this.students = null;\r\n          this.displayErrorAlert(students);\r\n        } else {\r\n          this.students = students;\r\n          for (let student of this.students) {\r\n            student.fullName = student.firstName + \" \" + student.lastName;\r\n            this.users.push(student);\r\n          }\r\n          this.getClients();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get students: \" + error));\r\n  }\r\n\r\n  getClients() {\r\n    this.ClientService\r\n      .getClients()\r\n      .then(clients => {\r\n        if ((clients as any).result === 'error') {\r\n          this.clients = null;\r\n          this.displayErrorAlert(clients);\r\n        } else {\r\n          this.clients = (clients as any).clients;\r\n          for (let client of this.clients) {\r\n            client.fullName = client.firstName + \" \" + client.lastName;\r\n            this.users.push(client);\r\n          }\r\n          this.getCourses();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get clients: \" + error));\r\n  }\r\n\r\n  getCourses() {\r\n    this.CourseService\r\n      .getCourseTypes()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.courseTypes = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.courseTypes = result;\r\n          this.getWaitList();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get courses: \" + error));\r\n  }\r\n\r\n  getWaitList() {\r\n    this.usersWaiting = [];\r\n    this.CourseService\r\n      .getWaitList()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.waitList = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.waitList = result;\r\n          for (let item of this.waitList) {\r\n             var user = this.users.filter(x => x.userID === item.userID);\r\n             //student[0].fullName = student[0].firstName + \" \" + student[0].lastName;\r\n             // student[0].courseID = course[0].courseID;\r\n             // student[0].professorId = course[0].professorId;\r\n             if (user[0] != null) {\r\n               if (user[0].studentID != null) {\r\n                 var userType = \"Student\";\r\n               } else {\r\n                 var userType = \"Client\";\r\n               }\r\n               user[0].courseName = item.courseType;\r\n               var userRecord = {\r\n                 id: user[0].userID,\r\n                 userType: userType,\r\n                 fullName: user[0].fullName,\r\n                 courseType: item.courseType,\r\n                 date: item.date\r\n               };\r\n               this.usersWaiting.push(userRecord);\r\n             }\r\n          }\r\n          this.getTimetables();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get wait list: \" + error));\r\n  }\r\n\r\n  getTimetables() {\r\n    this.StudentService\r\n      .getTimetables()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.timetables = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.timetables = result;\r\n          swal.close();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get timetables: \" + error));\r\n  }\r\n\r\n  showWaitListForm() {\r\n    this.showForm = true;\r\n  }\r\n\r\n  addStudentToWaitList() {\r\n    var CurrentDate = moment().format();\r\n   if (this.selectedUser == null || this.selectedCourseType == null) {\r\n      swal(\r\n        'Invalid Input',\r\n        'Please select both a student and a course.',\r\n        'warning'\r\n      );\r\n    } else {\r\n      swal({\r\n        title: 'Saving...',\r\n        allowOutsideClick: false\r\n      });\r\n      swal.showLoading();\r\n      this.courseWaitList = null;\r\n      this.showForm = false;\r\n      this.CourseService\r\n        .addToWaitList(this.selectedUser, this.selectedCourseType, CurrentDate)\r\n        .then(result => {\r\n          if ((result as any).result === 'error') {\r\n            this.displayErrorAlert(result);\r\n          } else if ((result as any).result === 'success')  {\r\n            this.getWaitList();\r\n            swal.close();\r\n          } else {\r\n            swal(\r\n              'Error',\r\n              'Something went wrong while adding student to wait list.',\r\n              'error'\r\n            );\r\n          }\r\n        })\r\n        .catch(error => console.log(\"Error - Add student to wait list: \" + error));\r\n    }\r\n  }\r\n\r\n  removeFromWaitList(data) {\r\n    this.CourseService\r\n      .removeFromWaitList(data.id, data.courseType)\r\n      .then(result => {\r\n        this.getWaitList();\r\n        swal(\r\n          'Removed from ' + data.courseType,\r\n          '' + data.fullName + ' has been succesfully removed from the ' + data.courseType + ' wait list.',\r\n          'success'\r\n        );\r\n      }).catch(error => error);\r\n  }\r\n\r\n  closeMenu() {\r\n    this.showForm = false;\r\n  }\r\n\r\n  gotoStudentEnrollment(data, event: any) {\r\n    this.router.navigate(['/student-enrollment', data.courseType, data.id ]);\r\n  }\r\n\r\n  viewCourseWaitList(data) {\r\n    this.viewingCourse = data;\r\n    this.usersWaiting = [];\r\n    this.courseWaitList = this.waitList.filter(x => x.courseType === data.courseType);\r\n    for (let item of this.courseWaitList) {\r\n       var user = this.users.filter(x => x.userID === item.userID);\r\n       if (user[0] != null) {\r\n         user[0].fullName = user[0].firstName + \" \" + user[0].lastName;\r\n         if (user[0].studentID != null) {\r\n           var userType = \"Student\";\r\n         } else {\r\n           var userType = \"Client\";\r\n         }\r\n         var userRecord = {\r\n           id: user[0].userID,\r\n           fullName: user[0].fullName,\r\n           userType: userType,\r\n           courseType: item.courseType,\r\n           date: item.date\r\n         };\r\n         this.usersWaiting.push(userRecord);\r\n       }\r\n    }\r\n  }\r\n\r\n  onPrint() {\r\n    (window as any).print();\r\n  }\r\n\r\n  displayErrorAlert(error) {\r\n    swal(\r\n      error.title,\r\n      error.msg,\r\n      'error'\r\n    );\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n}\r\n"]}