{"version":3,"sources":["../../client/app/components/wait-list/wait-list.component.ts"],"names":[],"mappings":"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","file":"wait-list.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { CourseService } from \"../../services/course.service\";\r\nimport { Course } from \"../../models/course\";\r\nimport { Student } from \"../../models/student\";\r\nimport { StudentService } from \"../../services/student.service\";\r\nimport { StaffService } from \"../../services/staff.service\";\r\ndeclare var swal: any;\r\ndeclare var moment;\r\n\r\n@Component({\r\n  selector: 'waitList',\r\n  templateUrl: './app/components/wait-list/wait-list.component.html',\r\n  styleUrls: ['./app/components/wait-list/wait-list.component.css']\r\n})\r\n\r\nexport class WaitListComponent implements OnInit {\r\n  data: any;\r\n  students: Student[];\r\n  courses: Course[];\r\n  waitList: any[];\r\n  timetables: any[];\r\n  courseWaitList: any[];\r\n  studentsWaiting:any = [];\r\n  viewingCourse: Course[];\r\n  selectedCourse: Course[];\r\n  selectedStudent: Student[];\r\n  showForm: boolean = false;\r\n\r\n  constructor(private router: Router, private CourseService: CourseService, private StudentService: StudentService, private StaffService: StaffService) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    swal({\r\n      title: 'Loading...',\r\n      allowOutsideClick: false\r\n    });\r\n    swal.showLoading();\r\n    this.getStudents();\r\n    //this.getTimetables();\r\n  }\r\n\r\n  getStudents() {\r\n    this.StudentService\r\n      .getStudents()\r\n      .then(students => {\r\n        if ((students as any).result === 'error') {\r\n          this.students = null;\r\n          this.displayErrorAlert(students);\r\n        } else {\r\n          this.students = students;\r\n          for (let student of this.students) {\r\n            student.fullName = student.firstName + \" \" + student.lastName;\r\n          }\r\n          this.getCourses();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get students: \" + error));\r\n  }\r\n\r\n  getCourses() {\r\n    this.CourseService\r\n      .getCourses()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.courses = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          //format datetime\r\n          result.forEach((item) => {\r\n            item.courseStart = moment(item.courseStart).format('YYYY-MM-DD');\r\n            item.courseEnd = moment(item.courseEnd).format('YYYY-MM-DD');\r\n            // item.classStartTime = moment(item.classStartTime).format('hh:mm A');\r\n            // item.classEndTime = moment(item.classEndTime).format('hh:mm A');\r\n          });\r\n          this.courses = result;\r\n          this.getWaitList();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get courses: \" + error));\r\n  }\r\n\r\n  getWaitList() {\r\n    this.studentsWaiting = [];\r\n    this.CourseService\r\n      .getWaitList()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.waitList = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.waitList = result;\r\n          for (let item of this.waitList) {\r\n             var student = this.students.filter(x => x.userID === item.studentID);\r\n             var course = this.courses.filter(x => x.courseID === item.courseID);\r\n             //student[0].fullName = student[0].firstName + \" \" + student[0].lastName;\r\n             // student[0].courseID = course[0].courseID;\r\n             // student[0].professorId = course[0].professorId;\r\n             student[0].courseName = course[0].courseName;\r\n             var studentRecord = {\r\n               fullName: student[0].fullName,\r\n               courseName: student[0].courseName,\r\n               date: item.date\r\n             };\r\n             this.studentsWaiting.push(studentRecord);\r\n          }\r\n          this.getTimetables();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get wait list: \" + error));\r\n  }\r\n\r\n  getTimetables() {\r\n    this.StudentService\r\n      .getTimetables()\r\n      .then(result => {\r\n        if ((result as any).result === 'error') {\r\n          this.timetables = null;\r\n          this.displayErrorAlert(result);\r\n        } else {\r\n          this.timetables = result;\r\n          swal.close();\r\n        }\r\n      })\r\n      .catch(error => console.log(\"Error - Get timetables: \" + error));\r\n  }\r\n\r\n  showWaitListForm() {\r\n    this.showForm = true;\r\n  }\r\n\r\n  addStudentToWaitList() {\r\n    var CurrentDate = moment().format();\r\n    var timetable = this.timetables.filter(x => x.courseID === this.selectedCourse && x.userID === this.selectedStudent);\r\n    if (timetable[0] != null) {\r\n        swal(\r\n          'Whoops!',\r\n          'That student is already enrolled in the selected course.',\r\n          'warning'\r\n        );\r\n    } else if (this.selectedStudent == null || this.selectedCourse == null) {\r\n      swal(\r\n        'Invalid Input',\r\n        'Please select both a student and a course.',\r\n        'warning'\r\n      );\r\n    } else {\r\n      swal({\r\n        title: 'Saving...',\r\n        allowOutsideClick: false\r\n      });\r\n      swal.showLoading();\r\n      this.courseWaitList = null;\r\n      this.showForm = false;\r\n      this.CourseService\r\n        .addToWaitList(this.selectedStudent, this.selectedCourse, CurrentDate)\r\n        .then(result => {\r\n          if ((result as any).result === 'error') {\r\n            this.displayErrorAlert(result);\r\n          } else if ((result as any).result === 'success')  {\r\n            this.getWaitList();\r\n            swal.close();\r\n          } else {\r\n            swal(\r\n              'Error',\r\n              'Something went wrong while adding student to wait list.',\r\n              'error'\r\n            );\r\n          }\r\n        })\r\n        .catch(error => console.log(\"Error - Add student to wait list: \" + error));\r\n    }\r\n  }\r\n\r\n  closeMenu() {\r\n    this.showForm = false;\r\n  }\r\n\r\n  gotoStudentEnrollment(course, data, event: any) {\r\n    if (course == null) {\r\n      course = this.courses.filter(x => x.courseName === data.courseName);\r\n      course = course[0];\r\n    }\r\n    this.router.navigate(['/student-enrollment', course.courseID, course.professorId, course.courseName]);\r\n  }\r\n\r\n  viewCourseWaitList(data) {\r\n    this.viewingCourse = data;\r\n    this.studentsWaiting = [];\r\n    this.courseWaitList = this.waitList.filter(x => x.courseID === data.courseID);\r\n    for (let item of this.courseWaitList) {\r\n       var student = this.students.filter(x => x.userID === item.studentID);\r\n       student[0].fullName = student[0].firstName + \" \" + student[0].lastName;\r\n       var studentRecord = {\r\n         fullName: student[0].fullName,\r\n         date: item.date\r\n       };\r\n       this.studentsWaiting.push(studentRecord);\r\n    }\r\n  }\r\n\r\n  onPrint() {\r\n    (window as any).print();\r\n  }\r\n\r\n  displayErrorAlert(error) {\r\n    swal(\r\n      error.title,\r\n      error.msg,\r\n      'error'\r\n    );\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n}\r\n"]}