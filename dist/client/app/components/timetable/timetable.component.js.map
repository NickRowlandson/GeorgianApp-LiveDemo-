{"version":3,"sources":["../../client/app/components/timetable/timetable.component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gBA2BE,4BAAoB,MAAc,EAAU,cAA8B,EAAU,aAA2B,EAAU,KAAqB;oBAA1H,WAAM,GAAN,MAAM,CAAQ;oBAAU,mBAAc,GAAd,cAAc,CAAgB;oBAAU,kBAAa,GAAb,aAAa,CAAc;oBAAU,UAAK,GAAL,KAAK,CAAgB;oBAT9I,WAAM,GAAU,EAAE,CAAC;oBAMnB,YAAO,GAAY,KAAK,CAAC;oBACzB,cAAS,GAAY,KAAK,CAAC;gBAI3B,CAAC;gBAED,qCAAQ,GAAR;oBAAA,iBA+DC;oBA9DC,IAAI,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC;oBAClE,IAAI,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC;oBAEhC,EAAE,CAAC,CAAC,WAAW,CAAC,QAAQ,KAAK,SAAS,CAAC,CAAC,CAAC;wBACvC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;wBACpB,IAAI,CAAC,cAAc;6BACd,WAAW,EAAE;6BACb,IAAI,CAAC,UAAA,QAAQ;4BACV,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;wBAC7B,CAAC,CAAC;6BACD,KAAK,CAAC,UAAA,KAAK;4BACV,eAAe;wBACjB,CAAC,CAAC,CAAC;wBAEP,IAAI,CAAC;4BACD,KAAK,EAAE,WAAW;4BAClB,IAAI,EAAE,sBAAsB;4BAC5B,KAAK,EAAE,MAAM;4BACb,gBAAgB,EAAE,cAAc;4BAChC,gBAAgB,EAAE,IAAI;4BACtB,SAAS,EAAE,gBAAgB;4BAC3B,kBAAkB,EAAE,SAAS;4BAC7B,iBAAiB,EAAE,KAAK;4BACxB,iBAAiB,EAAE,UAAU;4BAC7B,gBAAgB,EAAE,mBAAmB;yBACxC,CAAC,CAAC,IAAI,CAAC,UAAA,UAAU;4BAChB,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;gCACf,KAAI,CAAC,kBAAkB,GAAG,UAAU,CAAC,KAAK,CAAC;gCAC3C,IAAI,IAAI,GAAG,KAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gCAC9C,IAAI,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gCACxB,IAAI,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gCACvB,EAAE,CAAC,CAAC,SAAS,IAAI,IAAI,IAAI,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC;oCAC1C,KAAI,CAAC,KAAK,EAAE,CAAC;gCACf,CAAC;gCAAC,IAAI,CAAC,CAAC;oCACN,IAAI,CAAC;wCACH,KAAI,CAAC,eAAe,GAAG,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,SAAS,KAAK,SAAS,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,EAApD,CAAoD,CAAC,CAAC;wCACvG,KAAI,CAAC,aAAa,CAAC,KAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;wCACnD,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC;oCACxB,CAAC;oCAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;wCACX,KAAI,CAAC,KAAK,EAAE,CAAC;oCACf,CAAC;gCACH,CAAC;4BACH,CAAC;4BAAC,IAAI,CAAC,CAAC;gCACN,KAAI,CAAC,KAAK,EAAE,CAAC;4BACf,CAAC;wBACH,CAAC,CAAC,CAAC,KAAK,CAAC,UAAA,KAAK;4BACZ,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;4BACnB,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;wBACvC,CAAC,CAAC,CAAC;oBAEL,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACN,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;oBAC7B,CAAC;oBAED,IAAI,CAAC,OAAO,GAAG;wBACb,UAAU,EAAE,IAAI;wBAChB,IAAI,EAAE,mBAAmB;wBACzB,WAAW,EAAE,YAAY;wBACzB,OAAO,EAAE,UAAU;wBACnB,OAAO,EAAE,UAAU;wBACnB,MAAM,EAAE,MAAM;qBACf,CAAC;gBACJ,CAAC;gBAED,kCAAK,GAAL;oBAAA,iBAsCC;oBArCC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;oBACvB,IAAI,CAAC;wBACD,KAAK,EAAE,WAAW;wBAClB,IAAI,EAAE,4BAA4B;wBAClC,KAAK,EAAE,MAAM;wBACb,IAAI,EAAE,SAAS;wBACf,gBAAgB,EAAE,cAAc;wBAChC,gBAAgB,EAAE,IAAI;wBACtB,SAAS,EAAE,gBAAgB;wBAC3B,kBAAkB,EAAE,SAAS;wBAC7B,iBAAiB,EAAE,KAAK;wBACxB,iBAAiB,EAAE,UAAU;wBAC7B,gBAAgB,EAAE,mBAAmB;qBACxC,CAAC,CAAC,IAAI,CAAC,UAAA,UAAU;wBAChB,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;4BACf,KAAI,CAAC,kBAAkB,GAAG,UAAU,CAAC,KAAK,CAAC;4BAC3C,IAAI,IAAI,GAAG,KAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;4BAC9C,IAAI,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;4BACxB,IAAI,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;4BACvB,EAAE,CAAC,CAAC,SAAS,IAAI,IAAI,IAAI,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC;gCAC1C,KAAI,CAAC,KAAK,EAAE,CAAC;4BACf,CAAC;4BAAC,IAAI,CAAC,CAAC;gCACN,KAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gCACjB,IAAI,CAAC;oCACH,KAAI,CAAC,eAAe,GAAG,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,SAAS,KAAK,SAAS,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,EAApD,CAAoD,CAAC,CAAC;oCACvG,KAAI,CAAC,aAAa,CAAC,KAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;oCACnD,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gCACxB,CAAC;gCAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oCACX,KAAI,CAAC,KAAK,EAAE,CAAC;gCACf,CAAC;4BACH,CAAC;wBACH,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACN,KAAI,CAAC,KAAK,EAAE,CAAC;wBACf,CAAC;oBACH,CAAC,CAAC,CAAC,KAAK,CAAC,UAAA,KAAK;wBACZ,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;oBACvC,CAAC,CAAC,CAAC;gBACL,CAAC;gBAED,0CAAa,GAAb,UAAc,MAAM;oBAApB,iBA4CC;oBA3CC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAA,MAAM;wBACnD,MAAM,CAAC,OAAO,CAAC,UAAC,CAAC;4BACf,IAAI,QAAQ,GAAG,CAAC,CAAC;4BAEjB,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,CAAC,CAAC;gCAC5B,QAAQ,GAAG,CAAC,CAAC;4BACf,CAAC;4BAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,SAAS,CAAC,CAAC,CAAC;gCACpC,QAAQ,GAAG,CAAC,CAAC;4BACf,CAAC;4BAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,WAAW,CAAC,CAAC,CAAC;gCACtC,QAAQ,GAAG,CAAC,CAAC;4BACf,CAAC;4BAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,UAAU,CAAC,CAAC,CAAC;gCACrC,QAAQ,GAAG,CAAC,CAAC;4BACf,CAAC;4BAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,CAAC,CAAC;gCACnC,QAAQ,GAAG,CAAC,CAAC;4BACf,CAAC;4BAED,CAAC,CAAC,WAAW,GAAG,MAAM,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;4BAC3D,CAAC,CAAC,SAAS,GAAG,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;4BACvD,CAAC,CAAC,cAAc,GAAG,MAAM,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;4BAC9D,CAAC,CAAC,YAAY,GAAG,MAAM,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;4BAE1D,EAAE,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;gCACnB,IAAI,KAAK,GAAG,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gCACtC,GAAG,CAAC,CAAa,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAK;oCAAjB,IAAI,IAAI,cAAA;oCACX,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oCAC3B,IAAI,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oCAClB,IAAI,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oCACnB,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;oCACnC,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;oCACjC,KAAI,CAAC,MAAM,CAAC,IAAI,CACd;wCACE,OAAO,EAAE,CAAC,CAAC,UAAU;wCACrB,OAAO,EAAE,GAAG,GAAG,GAAG,GAAG,SAAS;wCAC9B,KAAK,EAAE,GAAG,GAAG,GAAG,GAAG,OAAO;qCAC3B,CAAC,CAAC;iCACN;4BACH,CAAC;4BAAC,IAAI,CAAC,CAAC;gCACN,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;4BAChD,CAAC;wBACH,CAAC,CAAC,CAAC;oBACL,CAAC,CAAC,CAAC,KAAK,CAAC,UAAA,KAAK;wBACZ,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;oBAC5C,CAAC,CAAC,CAAC;gBACL,CAAC;gBAED,mCAAM,GAAN;oBACE,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;gBACxB,CAAC;gBAvKQ;oBAAR,YAAK,EAAE;8CAAU,iBAAO;mEAAC;gBADf,kBAAkB;oBAN9B,gBAAS,CAAC;wBACT,QAAQ,EAAE,WAAW;wBACrB,WAAW,EAAE,qDAAqD;wBAClE,SAAS,EAAE,CAAC,oDAAoD,CAAC;qBAClE,CAAC;qDAa4B,eAAM,EAA0B,gCAAc,EAAwB,8BAAa,EAAiB,uBAAc;mBAXnI,kBAAkB,CAyK9B;gBAAD,yBAAC;aAzKD,AAyKC;;QACD,CAAC","file":"timetable.component.js","sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { ActivatedRoute, Params } from '@angular/router';\r\nimport { Course } from \"../../models/course\";\r\nimport { Student } from \"../../models/Student\";\r\nimport { StudentService } from \"../../services/student.service\";\r\nimport { CourseService} from '../../services/course.service';\r\ndeclare var moment: any;\r\ndeclare var swal: any;\r\n\r\n@Component({\r\n  selector: 'timetable',\r\n  templateUrl: './app/components/timetable/timetable.component.html',\r\n  styleUrls: ['./app/components/timetable/timetable.component.css']\r\n})\r\n\r\nexport class TimetableComponent implements OnInit {\r\n  @Input() student: Student;\r\n  events: any[] = [];\r\n  header: any;\r\n  options: any;\r\n  students: Student [];\r\n  selectedStudent: Student [];\r\n  studentSearchQuery: String;\r\n  faculty: boolean = false;\r\n  validInfo: boolean = false;\r\n\r\n  constructor(private router: Router, private studentService: StudentService, private courseService:CourseService, private route: ActivatedRoute) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    var currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n    var userID = currentUser.userID;\r\n\r\n    if (currentUser.userType !== \"Student\") {\r\n      this.faculty = true;\r\n      this.studentService\r\n          .getStudents()\r\n          .then(students => {\r\n              this.students = students;\r\n          })\r\n          .catch(error => {\r\n            // do something\r\n          });\r\n\r\n      swal({\r\n          title: 'Timetable',\r\n          text: 'Enter a student name',\r\n          input: \"text\",\r\n          inputPlaceholder: \"Student Name\",\r\n          showCancelButton: true,\r\n          animation: \"slide-from-top\",\r\n          confirmButtonColor: '#3085d6',\r\n          allowOutsideClick: false,\r\n          confirmButtonText: 'Continue',\r\n          cancelButtonText: 'Back to Dashboard'\r\n      }).then(inputValue => {\r\n        if (inputValue) {\r\n          this.studentSearchQuery = inputValue.value;\r\n          var name = this.studentSearchQuery.split(\" \");\r\n          var firstName = name[0];\r\n          var lastName = name[1];\r\n          if (firstName == null || lastName == null) {\r\n            this.alert();\r\n          } else {\r\n            try {\r\n              this.selectedStudent = this.students.filter(x => x.firstName === firstName && x.lastName === lastName);\r\n              this.getEventsById(this.selectedStudent[0].userID);\r\n              this.validInfo = true;\r\n            } catch (e) {\r\n              this.alert();\r\n            }\r\n          }\r\n        } else {\r\n          this.alert();\r\n        }\r\n      }).catch(error => {\r\n        console.log(error);\r\n        this.router.navigate(['/dashboard']);\r\n      });\r\n\r\n    } else {\r\n      this.getEventsById(userID);\r\n    }\r\n\r\n    this.options = {\r\n      selectable: true,\r\n      prev: 'circle-triangle-w',\r\n      defaultView: \"agendaWeek\",\r\n      minTime: \"08:00:00\",\r\n      maxTime: \"22:00:00\",\r\n      height: \"auto\"\r\n    };\r\n  }\r\n\r\n  alert() {\r\n    this.validInfo = false;\r\n    swal({\r\n        title: 'Timetable',\r\n        text: 'Enter a valid student name',\r\n        input: \"text\",\r\n        type: 'warning',\r\n        inputPlaceholder: \"Student Name\",\r\n        showCancelButton: true,\r\n        animation: \"slide-from-top\",\r\n        confirmButtonColor: '#3085d6',\r\n        allowOutsideClick: false,\r\n        confirmButtonText: 'Continue',\r\n        cancelButtonText: 'Back to Dashboard'\r\n    }).then(inputValue => {\r\n      if (inputValue) {\r\n        this.studentSearchQuery = inputValue.value;\r\n        var name = this.studentSearchQuery.split(\" \");\r\n        var firstName = name[0];\r\n        var lastName = name[1];\r\n        if (firstName == null || lastName == null) {\r\n          this.alert();\r\n        } else {\r\n          this.events = [];\r\n          try {\r\n            this.selectedStudent = this.students.filter(x => x.firstName === firstName && x.lastName === lastName);\r\n            this.getEventsById(this.selectedStudent[0].userID);\r\n            this.validInfo = true;\r\n          } catch (e) {\r\n            this.alert();\r\n          }\r\n        }\r\n      } else {\r\n        this.alert();\r\n      }\r\n    }).catch(error => {\r\n      this.router.navigate(['/dashboard']);\r\n    });\r\n  }\r\n\r\n  getEventsById(userID) {\r\n    this.studentService.getEventsById(userID).then(result => {\r\n      result.forEach((i) => {\r\n        var classDay = 0;\r\n\r\n        if (i.classDay === \"Monday\") {\r\n          classDay = 1;\r\n        } else if (i.classDay === \"Tuesday\") {\r\n          classDay = 2;\r\n        } else if (i.classDay === \"Wednesday\") {\r\n          classDay = 3;\r\n        } else if (i.classDay === \"Thursday\") {\r\n          classDay = 4;\r\n        } else if (i.classDay === \"Friday\") {\r\n          classDay = 5;\r\n        }\r\n\r\n        i.courseStart = moment(i.courseStart).format('YYYY-MM-DD');\r\n        i.courseEnd = moment(i.courseEnd).format('YYYY-MM-DD');\r\n        i.classStartTime = moment(i.classStartTime).format('hh:mm A');\r\n        i.classEndTime = moment(i.classEndTime).format('hh:mm A');\r\n\r\n        if (i.classTimeStr) {\r\n          var array = i.classTimeStr.split(',');\r\n          for (let item of array) {\r\n            var date = item.split(' ');\r\n            var day = date[0];\r\n            var time = date[1];\r\n            var startTime = time.split('-')[0];\r\n            var endTime = time.split('-')[1];\r\n            this.events.push(\r\n              {\r\n                \"title\": i.courseName,\r\n                \"start\": day + \"T\" + startTime,\r\n                \"end\": day + \"T\" + endTime\r\n              });\r\n          }\r\n        } else {\r\n          console.log(\"No class date string available\");\r\n        }\r\n      });\r\n    }).catch(error => {\r\n      console.log(\"Error getting events by id\");\r\n    });\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n}\r\n"]}