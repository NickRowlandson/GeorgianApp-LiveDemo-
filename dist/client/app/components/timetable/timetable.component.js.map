{"version":3,"sources":["../../client/app/components/timetable/timetable.component.ts"],"names":[],"mappings":"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","file":"timetable.component.js","sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { ActivatedRoute, Params } from '@angular/router';\r\nimport { Course } from \"../../models/course\";\r\nimport { Student } from \"../../models/Student\";\r\nimport { StudentService } from \"../../services/student.service\";\r\nimport { CourseService } from '../../services/course.service';\r\ndeclare var moment: any;\r\ndeclare var swal: any;\r\n\r\n@Component({\r\n  selector: 'timetable',\r\n  templateUrl: './app/components/timetable/timetable.component.html',\r\n  styleUrls: ['./app/components/timetable/timetable.component.css']\r\n})\r\n\r\nexport class TimetableComponent implements OnInit {\r\n  @Input() student: Student;\r\n  events: any[] = [];\r\n  header: any;\r\n  options: any;\r\n  students: Student[];\r\n  selectedStudent: number;\r\n  faculty: boolean = false;\r\n\r\n  constructor(private router: Router, private studentService: StudentService, private courseService: CourseService, private route: ActivatedRoute) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    var currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n    var userID = currentUser.userID;\r\n\r\n    if (currentUser.userType !== \"Student\") {\r\n      this.faculty = true;\r\n      this.studentService\r\n        .getStudents()\r\n        .then(students => {\r\n          if ((students as any).result === 'error') {\r\n            this.displayErrorAlert(students);\r\n          } else {\r\n            this.students = students;\r\n            this.getEventsById(this.selectedStudent[0].userID);\r\n          }\r\n        })\r\n        .catch(error => {\r\n          // do something\r\n        });\r\n    } else {\r\n      this.getEventsById(userID);\r\n    }\r\n\r\n    this.options = {\r\n      selectable: true,\r\n      prev: 'circle-triangle-w',\r\n      defaultView: \"agendaWeek\",\r\n      minTime: \"08:00:00\",\r\n      maxTime: \"22:00:00\",\r\n      height: \"auto\"\r\n    };\r\n  }\r\n\r\n  onPrint() {\r\n    (window as any).print();\r\n  }\r\n\r\n  studentSelect() {\r\n    swal({\r\n      title: 'Loading...',\r\n      allowOutsideClick: false\r\n    });\r\n    swal.showLoading();\r\n    this.getEventsById(this.selectedStudent);\r\n  }\r\n\r\n  getEventsById(userID) {\r\n    this.events = [];\r\n    this.studentService\r\n    .getEventsById(userID)\r\n    .then(result => {\r\n      if ((result as any).result === 'error') {\r\n        this.displayErrorAlert(result);\r\n      } else if ((result as any).title === 'No Timetable Info') {\r\n        var currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n        if (currentUser.userType !== \"Student\") {\r\n          swal(\r\n            'No Timetable Info',\r\n            'This student has not been enrolled in any classes yet.',\r\n            'warning'\r\n          );\r\n        } else {\r\n          swal(\r\n            'No Timetable Info',\r\n            'You have not been enrolled in any classes yet.',\r\n            'warning'\r\n          );\r\n        }\r\n      } else {\r\n        result.forEach((i) => {\r\n          var classDay = 0;\r\n\r\n          if (i.classDay === \"Monday\") {\r\n            classDay = 1;\r\n          } else if (i.classDay === \"Tuesday\") {\r\n            classDay = 2;\r\n          } else if (i.classDay === \"Wednesday\") {\r\n            classDay = 3;\r\n          } else if (i.classDay === \"Thursday\") {\r\n            classDay = 4;\r\n          } else if (i.classDay === \"Friday\") {\r\n            classDay = 5;\r\n          }\r\n\r\n          i.courseStart = moment(i.courseStart).format('YYYY-MM-DD');\r\n          i.courseEnd = moment(i.courseEnd).format('YYYY-MM-DD');\r\n          i.classStartTime = moment(i.classStartTime).format('hh:mm A');\r\n          i.classEndTime = moment(i.classEndTime).format('hh:mm A');\r\n\r\n          if (i.classTimeStr) {\r\n            var array = i.classTimeStr.split(',');\r\n            for (let item of array) {\r\n              var date = item.split(' ');\r\n              var day = date[0];\r\n              var time = date[1];\r\n              var startTime = time.split('-')[0];\r\n              var endTime = time.split('-')[1];\r\n              this.events.push(\r\n                {\r\n                  \"title\": i.courseName,\r\n                  \"start\": day + \"T\" + startTime,\r\n                  \"end\": day + \"T\" + endTime\r\n                });\r\n            }\r\n          } else {\r\n            console.log(\"No class date string available\");\r\n          }\r\n        });\r\n        swal.close();\r\n      }\r\n    }).catch(error => {\r\n      console.log(\"Error getting events by id\");\r\n    });\r\n  }\r\n\r\n  displayErrorAlert(error) {\r\n    if (error.title === \"Auth Error\") {\r\n      this.router.navigate(['/login']);\r\n      swal(\r\n        error.title,\r\n        error.msg,\r\n        'info'\r\n      );\r\n    } else {\r\n      swal(\r\n        error.title,\r\n        error.msg,\r\n        'error'\r\n      );\r\n    }\r\n  }\r\n\r\n  goBack() {\r\n    window.history.back();\r\n  }\r\n}\r\n"]}