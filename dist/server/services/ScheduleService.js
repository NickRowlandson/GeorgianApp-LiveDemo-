var schedule = require('node-schedule');
var MailService = require("./MailService");
var sql = require('mssql');
var config = require('../config');
//runs every night at 10pm
var attendanceCheck = schedule.scheduleJob('0 30 19 * * *', function () {
    var date = new Date();
    var twoMissedClasses = 0, fourMissedClasses = 0;
    var student;
    try {
        sql.connect(config.db)
            .then(function (connection) {
            new sql.Request(connection)
                .query("SELECT * FROM Attendance ORDER BY date DESC")
                .then(function (attendanceResult) {
                new sql.Request(connection)
                    .query("SELECT userID, firstName, lastName FROM Students")
                    .then(function (studentsResult) {
                    new sql.Request(connection)
                        .query("SELECT userID, email FROM Users")
                        .then(function (usersResult) {
                        new sql.Request(connection)
                            .query("SELECT courseID, courseName FROM Course")
                            .then(function (coursesResult) {
                            var _loop_1 = function (student_1) {
                                userInfo = usersResult.filter(function (x) { return x.userID === student_1.userID; });
                                studentAttendance = attendanceResult.filter(function (x) { return x.userID === student_1.userID; });
                                console.log("# of attendance records for " + student_1.firstName + ": " + studentAttendance.length);
                                function courseBy(array, f) {
                                    var courses = {};
                                    array.forEach(function (o) {
                                        var course = JSON.stringify(f(o));
                                        courses[course] = courses[course] || [];
                                        courses[course].push(o);
                                    });
                                    return Object.keys(courses).map(function (course) {
                                        return courses[course];
                                    });
                                }
                                result = courseBy(studentAttendance, function (item) {
                                    return [item.courseID, item.userID];
                                });
                                var _loop_2 = function (course) {
                                    var _loop_3 = function () {
                                        availableCourses = course.filter(function (x) { return x.fourMissedClassMsg === false; });
                                        if (availableCourses.length >= 4 && course[i + 1] != null && course[i + 2] != null && course[i + 3] != null) {
                                            if (course[i].fourMissedClassMsg === false &&
                                                course[i + 1].fourMissedClassMsg === false &&
                                                course[i + 2].fourMissedClassMsg === false &&
                                                course[i + 3].fourMissedClassMsg === false &&
                                                course[i].attendanceValue === 'A' &&
                                                course[i + 1].attendanceValue === 'A' &&
                                                course[i + 2].attendanceValue === 'A' &&
                                                course[i + 3].attendanceValue === 'A') {
                                                //mark attendance records as reviewed and message sent
                                                course[i].fourMissedClassMsg = true;
                                                course[i + 1].fourMissedClassMsg = true;
                                                course[i + 2].fourMissedClassMsg = true;
                                                course[i + 3].fourMissedClassMsg = true;
                                                course[i].twoMissedClassMsg = true;
                                                course[i + 1].twoMissedClassMsg = true;
                                                course[i + 2].twoMissedClassMsg = true;
                                                course[i + 3].twoMissedClassMsg = true;
                                                courseInfo = coursesResult.filter(function (x) { return x.courseID === course[i].courseID; });
                                                console.log("__________________________________________________________________________________________");
                                                console.log("Four consecutive classes missed by: " + student_1.firstName + " " + student_1.lastName);
                                                console.log("Student ID: " + course[i].userID + " - " + course[i + 1].userID);
                                                console.log("Dates: " + course[i].date + ' & ' + course[i + 1].date + ' & ' + course[i + 2].date + ' & ' + course[i + 3].date);
                                                console.log("Course ID: " + course[i].courseID + " - " + course[i + 1].courseID);
                                                console.log("Email: " + userInfo[0].email);
                                                console.log("__________________________________________________________________________________________");
                                                fourMissedClasses += 1;
                                                var mailOptions_1 = {
                                                    from: config.mail.user,
                                                    to: userInfo[0].email,
                                                    subject: 'Removal from ' + courseInfo[0].courseName,
                                                    text: '',
                                                    html: 'Hi ' + student_1.firstName + ',<br /><br />Our records indicate that you have missed 50% or more of your ' + courseInfo[0].courseName +
                                                        ' classes in the last four weeks. Our policy states that students will be withdrawn when this much time has been missed. Unfortunately, ' +
                                                        'this means that you are being exited from ' + courseInfo[0].courseName + ' class.<br /><br />Please contact me by phone at 705-728-1968, Ext. XXXX or by ' +
                                                        'email at <a>Cheryl.Boyes@GeorgianCollege.ca</a> to complete the necessary paperwork and discuss possible opportunities for returning to the ' +
                                                        courseInfo[0].courseName + ' class at a later date.<br /><br />Regards,<br /><br /><strong>Cheryl Boyes</strong><br /><strong>Academic Upgrading Officer</strong>' +
                                                        '<br />Georgian College| One Georgian Drive | Barrie ON | L4M 3X9' // html body
                                                };
                                                query = "UPDATE Attendance SET fourMissedClassMsg = 'true', twoMissedClassMsg = 'true' WHERE attendanceID IN" +
                                                    " ('" + course[i].attendanceID + "','" + course[i + 1].attendanceID + "','" + course[i + 2].attendanceID + "','" + course[i + 3].attendanceID + "')";
                                                new sql.Request(connection)
                                                    .query(query)
                                                    .then(function (result) {
                                                    new MailService().sendMessage('Four Missed Classes', mailOptions_1);
                                                }).catch(function (err) {
                                                    console.log("Update attendance records: " + err);
                                                });
                                            }
                                        }
                                        if (course.length >= 2 && course[i + 1] != null) {
                                            if (course[i].attendanceValue === 'A' &&
                                                course[i + 1].attendanceValue === 'A' &&
                                                course[i].twoMissedClassMsg === false &&
                                                course[i + 1].twoMissedClassMsg === false) {
                                                //mark attendance records as reviewed and message sent
                                                course[i].twoMissedClassMsg = true;
                                                course[i + 1].twoMissedClassMsg = true;
                                                courseInfo = coursesResult.filter(function (x) { return x.courseID === course[i].courseID; });
                                                console.log("__________________________________________________________________________________________");
                                                console.log("Two consecutive classes have been missed by: " + student_1.firstName + " " + student_1.lastName);
                                                console.log("Student ID: " + course[i].userID + " - " + course[i + 1].userID);
                                                console.log("Dates: " + course[i].date + ' & ' + course[i + 1].date);
                                                console.log("Course ID: " + course[i].courseID + " - " + course[i + 1].courseID);
                                                console.log("Email: " + userInfo[0].email);
                                                console.log("__________________________________________________________________________________________");
                                                twoMissedClasses += 1;
                                                var mailOptions_2 = {
                                                    from: config.mail.user,
                                                    to: userInfo[0].email,
                                                    subject: 'Two Missed ' + courseInfo[0].courseName + ' Classes',
                                                    text: '',
                                                    html: 'Hi ' + student_1.firstName + ',<br /><br />I noticed that you missed the last two consecutive ' + courseInfo[0].courseName + ' classes.' +
                                                        ' I hope everything is okay. Let me know if there is something I can do to help.<br /><br />Please be reminded of our program ' +
                                                        'policy that states students are responsible to notify their instructors when they will be absent. In addition, the policy directs ' +
                                                        'students to arrange for a leave of absence if they need to miss two or more classes in a row. A leave of absence can be arranged with ' +
                                                        'Cheryl Boyes, who can contacted by phone at 705-728-1968, Ext. XXXX or by email at <a>Cheryl.Boyes@GeorgianCollege.ca</a><br /><br />Please ' +
                                                        'get in touch with me as soon as possible. Unfortunately, if I don’t hear from you, and you miss the next two classes, you risk being withdrawn ' +
                                                        'from ' + courseInfo[0].courseName + '.<br /><br />Best Regards,<br /><br /><strong>Joanne Pineda, MA AdEd</strong><br /><strong>Academic Preparation Faculty' +
                                                        '</strong><br /><br />Georgian College| One Georgian Drive | Barrie ON | L4M 3X9' // html body
                                                };
                                                query = "UPDATE Attendance SET twoMissedClassMsg = 'true' WHERE attendanceID IN ('" + course[i].attendanceID + "','" + course[i + 1].attendanceID + "')";
                                                new sql.Request(connection)
                                                    .query(query)
                                                    .then(function (result) {
                                                    new MailService().sendMessage('Two Missed Classes', mailOptions_2);
                                                }).catch(function (err) {
                                                    console.log("Select userID and email from all users " + err);
                                                });
                                            }
                                        }
                                    };
                                    for (var i = 0; i < course.length - 1; i++) {
                                        _loop_3();
                                    }
                                };
                                for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {
                                    var course = result_1[_i];
                                    _loop_2(course);
                                }
                            };
                            var userInfo, studentAttendance, result, availableCourses, courseInfo, query, courseInfo, query;
                            for (var _i = 0, studentsResult_1 = studentsResult; _i < studentsResult_1.length; _i++) {
                                var student_1 = studentsResult_1[_i];
                                _loop_1(student_1);
                            }
                            var mailOptionsAdmin = {
                                from: 'academic.career.prep@gmail.com',
                                to: 'academic.career.prep@gmail.com',
                                subject: 'SCHEDULER ✔',
                                text: '',
                                html: '<b> Hi admin!</b><br  /><br  />There were <strong>' + twoMissedClasses + '</strong> emails sent out due to missed classes today. <br/> There were <strong>' +
                                    fourMissedClasses + '</strong> removals from a course today.' // html body
                            };
                            new MailService().sendMessage("Scheduled Message", mailOptionsAdmin);
                            console.log("TOTAL WARNING EMAILS SENT: " + twoMissedClasses);
                            console.log("TOTAL REMOVAL EMAILS SENT: " + fourMissedClasses);
                        }).catch(function (err) {
                            console.log("Select courseID and courseName from all courses " + err);
                        });
                    }).catch(function (err) {
                        console.log("Select userID and email from all users " + err);
                    });
                }).catch(function (err) {
                    console.log("Select all students " + err);
                });
            }).catch(function (err) {
                console.log("Get all attendance " + err);
            });
        }).catch(function (err) {
            console.log(err);
        });
    }
    catch (err) {
        console.log(err);
    }
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9zcmMvc2VydmljZXMvU2NoZWR1bGVTZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUMxQyxJQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDN0MsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQzNCLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUVsQywwQkFBMEI7QUFDMUIsSUFBSSxlQUFlLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxlQUFlLEVBQUU7SUFDMUQsSUFBSSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUN0QixJQUFJLGdCQUFnQixHQUFHLENBQUMsRUFBRSxpQkFBaUIsR0FBRyxDQUFDLENBQUM7SUFDaEQsSUFBSSxPQUFPLENBQUM7SUFFWixJQUFJO1FBQ0YsR0FBRyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO2FBQ25CLElBQUksQ0FBQyxVQUFTLFVBQVU7WUFDdkIsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztpQkFDeEIsS0FBSyxDQUFDLDZDQUE2QyxDQUFDO2lCQUNwRCxJQUFJLENBQUMsVUFBUyxnQkFBZ0I7Z0JBQzdCLElBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7cUJBQ3hCLEtBQUssQ0FBQyxrREFBa0QsQ0FBQztxQkFDekQsSUFBSSxDQUFDLFVBQVMsY0FBYztvQkFDM0IsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQzt5QkFDeEIsS0FBSyxDQUFDLGlDQUFpQyxDQUFDO3lCQUN4QyxJQUFJLENBQUMsVUFBUyxXQUFXO3dCQUN4QixJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDOzZCQUN4QixLQUFLLENBQUMseUNB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QyxVQUFTLEdBQUc7d0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMseUNBQXlDLEdBQUcsR0FBRyxDQUFDLENBQUM7b0JBQy9ELENBQUMsQ0FBQyxDQUFDO2dCQUNQLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEdBQUc7b0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEdBQUcsR0FBRyxDQUFDLENBQUM7Z0JBQzVDLENBQUMsQ0FBQyxDQUFDO1lBQ1AsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsR0FBRztnQkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsR0FBRyxHQUFHLENBQUMsQ0FBQztZQUMzQyxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEdBQUc7WUFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuQixDQUFDLENBQUMsQ0FBQztLQUNOO0lBQ0QsT0FBTyxHQUFHLEVBQUU7UUFDVixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQ2xCO0FBRUgsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoic2VydmljZXMvU2NoZWR1bGVTZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2NoZWR1bGUgPSByZXF1aXJlKCdub2RlLXNjaGVkdWxlJyk7XHJcbmNvbnN0IE1haWxTZXJ2aWNlID0gcmVxdWlyZShcIi4vTWFpbFNlcnZpY2VcIik7XHJcbnZhciBzcWwgPSByZXF1aXJlKCdtc3NxbCcpO1xyXG52YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7XHJcblxyXG4vL3J1bnMgZXZlcnkgbmlnaHQgYXQgMTBwbVxyXG52YXIgYXR0ZW5kYW5jZUNoZWNrID0gc2NoZWR1bGUuc2NoZWR1bGVKb2IoJzAgMzAgMTkgKiAqIConLCBmdW5jdGlvbigpIHtcclxuICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgdmFyIHR3b01pc3NlZENsYXNzZXMgPSAwLCBmb3VyTWlzc2VkQ2xhc3NlcyA9IDA7XHJcbiAgdmFyIHN0dWRlbnQ7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBzcWwuY29ubmVjdChjb25maWcuZGIpXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKGNvbm5lY3Rpb24pIHtcclxuICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgIC5xdWVyeShcIlNFTEVDVCAqIEZST00gQXR0ZW5kYW5jZSBPUkRFUiBCWSBkYXRlIERFU0NcIilcclxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGF0dGVuZGFuY2VSZXN1bHQpIHtcclxuICAgICAgICAgICAgbmV3IHNxbC5SZXF1ZXN0KGNvbm5lY3Rpb24pXHJcbiAgICAgICAgICAgICAgLnF1ZXJ5KFwiU0VMRUNUIHVzZXJJRCwgZmlyc3ROYW1lLCBsYXN0TmFtZSBGUk9NIFN0dWRlbnRzXCIpXHJcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3R1ZGVudHNSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIG5ldyBzcWwuUmVxdWVzdChjb25uZWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAucXVlcnkoXCJTRUxFQ1QgdXNlcklELCBlbWFpbCBGUk9NIFVzZXJzXCIpXHJcbiAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHVzZXJzUmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IHNxbC5SZXF1ZXN0KGNvbm5lY3Rpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAucXVlcnkoXCJTRUxFQ1QgY291cnNlSUQsIGNvdXJzZU5hbWUgRlJPTSBDb3Vyc2VcIilcclxuICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGNvdXJzZXNSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgc3R1ZGVudCBvZiBzdHVkZW50c1Jlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySW5mbyA9IHVzZXJzUmVzdWx0LmZpbHRlcih4ID0+IHgudXNlcklEID09PSBzdHVkZW50LnVzZXJJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0dWRlbnRBdHRlbmRhbmNlID0gYXR0ZW5kYW5jZVJlc3VsdC5maWx0ZXIoeCA9PiB4LnVzZXJJRCA9PT0gc3R1ZGVudC51c2VySUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiIyBvZiBhdHRlbmRhbmNlIHJlY29yZHMgZm9yIFwiICsgc3R1ZGVudC5maXJzdE5hbWUgKyBcIjogXCIgKyBzdHVkZW50QXR0ZW5kYW5jZS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvdXJzZUJ5KGFycmF5LCBmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291cnNlcyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3Vyc2UgPSBKU09OLnN0cmluZ2lmeShmKG8pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlc1tjb3Vyc2VdID0gY291cnNlc1tjb3Vyc2VdIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VzW2NvdXJzZV0ucHVzaChvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGNvdXJzZXMpLm1hcChmdW5jdGlvbihjb3Vyc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvdXJzZXNbY291cnNlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBjb3Vyc2VCeShzdHVkZW50QXR0ZW5kYW5jZSwgZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtpdGVtLmNvdXJzZUlELCBpdGVtLnVzZXJJRF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgY291cnNlIG9mIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3Vyc2UubGVuZ3RoLTE7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXZhaWxhYmxlQ291cnNlcyA9IGNvdXJzZS5maWx0ZXIoeCA9PiB4LmZvdXJNaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXZhaWxhYmxlQ291cnNlcy5sZW5ndGggPj0gNCAgJiYgY291cnNlW2kgKyAxXSAhPSBudWxsICYmIGNvdXJzZVtpICsgMl0gIT0gbnVsbCAmJiBjb3Vyc2VbaSArIDNdICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291cnNlW2ldLmZvdXJNaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0uZm91ck1pc3NlZENsYXNzTXNnID09PSBmYWxzZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAyXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPT09IGZhbHNlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDNdLmZvdXJNaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS5hdHRlbmRhbmNlVmFsdWUgPT09ICdBJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS5hdHRlbmRhbmNlVmFsdWUgPT09ICdBJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAyXS5hdHRlbmRhbmNlVmFsdWUgPT09ICdBJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAzXS5hdHRlbmRhbmNlVmFsdWUgPT09ICdBJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9tYXJrIGF0dGVuZGFuY2UgcmVjb3JkcyBhcyByZXZpZXdlZCBhbmQgbWVzc2FnZSBzZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaV0uZm91ck1pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0uZm91ck1pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMl0uZm91ck1pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgM10uZm91ck1pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS50d29NaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDFdLnR3b01pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMl0udHdvTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAzXS50d29NaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291cnNlSW5mbyA9IGNvdXJzZXNSZXN1bHQuZmlsdGVyKHggPT4geC5jb3Vyc2VJRCA9PT0gY291cnNlW2ldLmNvdXJzZUlEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGb3VyIGNvbnNlY3V0aXZlIGNsYXNzZXMgbWlzc2VkIGJ5OiBcIiArIHN0dWRlbnQuZmlyc3ROYW1lICsgXCIgXCIgKyBzdHVkZW50Lmxhc3ROYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3R1ZGVudCBJRDogXCIgKyBjb3Vyc2VbaV0udXNlcklEICsgXCIgLSBcIiArIGNvdXJzZVtpICsgMV0udXNlcklEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZXM6IFwiICsgY291cnNlW2ldLmRhdGUgKyAnICYgJyArIGNvdXJzZVtpICsgMV0uZGF0ZSArICcgJiAnICsgY291cnNlW2kgKyAyXS5kYXRlICsgJyAmICcgKyBjb3Vyc2VbaSArIDNdLmRhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDb3Vyc2UgSUQ6IFwiICsgY291cnNlW2ldLmNvdXJzZUlEICsgXCIgLSBcIiArIGNvdXJzZVtpICsgMV0uY291cnNlSUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFbWFpbDogXCIgKyB1c2VySW5mb1swXS5lbWFpbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdXJNaXNzZWRDbGFzc2VzICs9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWFpbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IGNvbmZpZy5tYWlsLnVzZXIsIC8vIHNlbmRlciBhZGRyZXNzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvOiB1c2VySW5mb1swXS5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdDogJ1JlbW92YWwgZnJvbSAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lLCAvLyBTdWJqZWN0IGxpbmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJycsIC8vIHBsYWluIHRleHQgYm9keVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sOiAnSGkgJyArIHN0dWRlbnQuZmlyc3ROYW1lICsgJyw8YnIgLz48YnIgLz5PdXIgcmVjb3JkcyBpbmRpY2F0ZSB0aGF0IHlvdSBoYXZlIG1pc3NlZCA1MCUgb3IgbW9yZSBvZiB5b3VyICcgKyBjb3Vyc2VJbmZvWzBdLmNvdXJzZU5hbWUgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIGNsYXNzZXMgaW4gdGhlIGxhc3QgZm91ciB3ZWVrcy4gT3VyIHBvbGljeSBzdGF0ZXMgdGhhdCBzdHVkZW50cyB3aWxsIGJlIHdpdGhkcmF3biB3aGVuIHRoaXMgbXVjaCB0aW1lIGhhcyBiZWVuIG1pc3NlZC4gVW5mb3J0dW5hdGVseSwgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aGlzIG1lYW5zIHRoYXQgeW91IGFyZSBiZWluZyBleGl0ZWQgZnJvbSAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lICsgJyBjbGFzcy48YnIgLz48YnIgLz5QbGVhc2UgY29udGFjdCBtZSBieSBwaG9uZSBhdCA3MDUtNzI4LTE5NjgsIEV4dC4gWFhYWCBvciBieSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VtYWlsIGF0IDxhPkNoZXJ5bC5Cb3llc0BHZW9yZ2lhbkNvbGxlZ2UuY2E8L2E+IHRvIGNvbXBsZXRlIHRoZSBuZWNlc3NhcnkgcGFwZXJ3b3JrIGFuZCBkaXNjdXNzIHBvc3NpYmxlIG9wcG9ydHVuaXRpZXMgZm9yIHJldHVybmluZyB0byB0aGUgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArICcgY2xhc3MgYXQgYSBsYXRlciBkYXRlLjxiciAvPjxiciAvPlJlZ2FyZHMsPGJyIC8+PGJyIC8+PHN0cm9uZz5DaGVyeWwgQm95ZXM8L3N0cm9uZz48YnIgLz48c3Ryb25nPkFjYWRlbWljIFVwZ3JhZGluZyBPZmZpY2VyPC9zdHJvbmc+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YnIgLz5HZW9yZ2lhbiBDb2xsZWdlfCBPbmUgR2VvcmdpYW4gRHJpdmUgfCBCYXJyaWUgT04gfCBMNE0gM1g5JyAvLyBodG1sIGJvZHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSBcIlVQREFURSBBdHRlbmRhbmNlIFNFVCBmb3VyTWlzc2VkQ2xhc3NNc2cgPSAndHJ1ZScsIHR3b01pc3NlZENsYXNzTXNnID0gJ3RydWUnIFdIRVJFIGF0dGVuZGFuY2VJRCBJTlwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiICgnXCIgKyBjb3Vyc2VbaV0uYXR0ZW5kYW5jZUlEICtcIicsJ1wiICsgY291cnNlW2krMV0uYXR0ZW5kYW5jZUlEICtcIicsJ1wiICsgY291cnNlW2krMl0uYXR0ZW5kYW5jZUlEICtcIicsJ1wiICsgY291cnNlW2krM10uYXR0ZW5kYW5jZUlEICtcIicpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5KHF1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFpbFNlcnZpY2UoKS5zZW5kTWVzc2FnZSgnRm91ciBNaXNzZWQgQ2xhc3NlcycsIG1haWxPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVcGRhdGUgYXR0ZW5kYW5jZSByZWNvcmRzOiBcIiArIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291cnNlLmxlbmd0aCA+PSAyICYmIGNvdXJzZVtpICsgMV0gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3Vyc2VbaV0uYXR0ZW5kYW5jZVZhbHVlID09PSAnQScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0uYXR0ZW5kYW5jZVZhbHVlID09PSAnQScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS50d29NaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0udHdvTWlzc2VkQ2xhc3NNc2cgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL21hcmsgYXR0ZW5kYW5jZSByZWNvcmRzIGFzIHJldmlld2VkIGFuZCBtZXNzYWdlIHNlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS50d29NaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDFdLnR3b01pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3Vyc2VJbmZvID0gY291cnNlc1Jlc3VsdC5maWx0ZXIoeCA9PiB4LmNvdXJzZUlEID09PSBjb3Vyc2VbaV0uY291cnNlSUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlR3byBjb25zZWN1dGl2ZSBjbGFzc2VzIGhhdmUgYmVlbiBtaXNzZWQgYnk6IFwiICsgc3R1ZGVudC5maXJzdE5hbWUgKyBcIiBcIiArIHN0dWRlbnQubGFzdE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdHVkZW50IElEOiBcIiArIGNvdXJzZVtpXS51c2VySUQgKyBcIiAtIFwiICsgY291cnNlW2kgKyAxXS51c2VySUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRlczogXCIgKyBjb3Vyc2VbaV0uZGF0ZSArICcgJiAnICsgY291cnNlW2kgKyAxXS5kYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ291cnNlIElEOiBcIiArIGNvdXJzZVtpXS5jb3Vyc2VJRCArIFwiIC0gXCIgKyBjb3Vyc2VbaSArIDFdLmNvdXJzZUlEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRW1haWw6IFwiICsgdXNlckluZm9bMF0uZW1haWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0d29NaXNzZWRDbGFzc2VzICs9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWFpbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IGNvbmZpZy5tYWlsLnVzZXIsIC8vIHNlbmRlciBhZGRyZXNzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvOiB1c2VySW5mb1swXS5lbWFpbCwgLy8gc3R1ZGVudC5lbWFpbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0OiAnVHdvIE1pc3NlZCAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lICsgJyBDbGFzc2VzJywgLy8gU3ViamVjdCBsaW5lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICcnLCAvLyBwbGFpbiB0ZXh0IGJvZHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbDogJ0hpICcgKyBzdHVkZW50LmZpcnN0TmFtZSArICcsPGJyIC8+PGJyIC8+SSBub3RpY2VkIHRoYXQgeW91IG1pc3NlZCB0aGUgbGFzdCB0d28gY29uc2VjdXRpdmUgJyArIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArICcgY2xhc3Nlcy4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyBJIGhvcGUgZXZlcnl0aGluZyBpcyBva2F5LiBMZXQgbWUga25vdyBpZiB0aGVyZSBpcyBzb21ldGhpbmcgSSBjYW4gZG8gdG8gaGVscC48YnIgLz48YnIgLz5QbGVhc2UgYmUgcmVtaW5kZWQgb2Ygb3VyIHByb2dyYW0gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwb2xpY3kgdGhhdCBzdGF0ZXMgc3R1ZGVudHMgYXJlIHJlc3BvbnNpYmxlIHRvIG5vdGlmeSB0aGVpciBpbnN0cnVjdG9ycyB3aGVuIHRoZXkgd2lsbCBiZSBhYnNlbnQuIEluIGFkZGl0aW9uLCB0aGUgcG9saWN5IGRpcmVjdHMgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdHVkZW50cyB0byBhcnJhbmdlIGZvciBhIGxlYXZlIG9mIGFic2VuY2UgaWYgdGhleSBuZWVkIHRvIG1pc3MgdHdvIG9yIG1vcmUgY2xhc3NlcyBpbiBhIHJvdy4gQSBsZWF2ZSBvZiBhYnNlbmNlIGNhbiBiZSBhcnJhbmdlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ2hlcnlsIEJveWVzLCB3aG8gY2FuIGNvbnRhY3RlZCBieSBwaG9uZSBhdCA3MDUtNzI4LTE5NjgsIEV4dC4gWFhYWCBvciBieSBlbWFpbCBhdCA8YT5DaGVyeWwuQm95ZXNAR2VvcmdpYW5Db2xsZWdlLmNhPC9hPjxiciAvPjxiciAvPlBsZWFzZSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2dldCBpbiB0b3VjaCB3aXRoIG1lIGFzIHNvb24gYXMgcG9zc2libGUuIFVuZm9ydHVuYXRlbHksIGlmIEkgZG9u4oCZdCBoZWFyIGZyb20geW91LCBhbmQgeW91IG1pc3MgdGhlIG5leHQgdHdvIGNsYXNzZXMsIHlvdSByaXNrIGJlaW5nIHdpdGhkcmF3biAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Zyb20gJyArIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArICcuPGJyIC8+PGJyIC8+QmVzdCBSZWdhcmRzLDxiciAvPjxiciAvPjxzdHJvbmc+Sm9hbm5lIFBpbmVkYSwgTUEgQWRFZDwvc3Ryb25nPjxiciAvPjxzdHJvbmc+QWNhZGVtaWMgUHJlcGFyYXRpb24gRmFjdWx0eScgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9zdHJvbmc+PGJyIC8+PGJyIC8+R2VvcmdpYW4gQ29sbGVnZXwgT25lIEdlb3JnaWFuIERyaXZlIHwgQmFycmllIE9OIHwgTDRNIDNYOScgLy8gaHRtbCBib2R5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCJVUERBVEUgQXR0ZW5kYW5jZSBTRVQgdHdvTWlzc2VkQ2xhc3NNc2cgPSAndHJ1ZScgV0hFUkUgYXR0ZW5kYW5jZUlEIElOICgnXCIgKyBjb3Vyc2VbaV0uYXR0ZW5kYW5jZUlEICtcIicsJ1wiICsgY291cnNlW2krMV0uYXR0ZW5kYW5jZUlEICtcIicpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5KHF1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFpbFNlcnZpY2UoKS5zZW5kTWVzc2FnZSgnVHdvIE1pc3NlZCBDbGFzc2VzJywgbWFpbE9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbGVjdCB1c2VySUQgYW5kIGVtYWlsIGZyb20gYWxsIHVzZXJzIFwiICsgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYWlsT3B0aW9uc0FkbWluID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdhY2FkZW1pYy5jYXJlZXIucHJlcEBnbWFpbC5jb20nLCAvLyBzZW5kZXIgYWRkcmVzc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRvOiAnYWNhZGVtaWMuY2FyZWVyLnByZXBAZ21haWwuY29tJywgLy8gbGlzdCBvZiByZWNlaXZlcnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0OiAnU0NIRURVTEVSIOKclCcsIC8vIFN1YmplY3QgbGluZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICcnLCAvLyBwbGFpbiB0ZXh0IGJvZHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sOiAnPGI+IEhpIGFkbWluITwvYj48YnIgIC8+PGJyICAvPlRoZXJlIHdlcmUgPHN0cm9uZz4nICsgdHdvTWlzc2VkQ2xhc3NlcyArICc8L3N0cm9uZz4gZW1haWxzIHNlbnQgb3V0IGR1ZSB0byBtaXNzZWQgY2xhc3NlcyB0b2RheS4gPGJyLz4gVGhlcmUgd2VyZSA8c3Ryb25nPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvdXJNaXNzZWRDbGFzc2VzICsgJzwvc3Ryb25nPiByZW1vdmFscyBmcm9tIGEgY291cnNlIHRvZGF5LicgLy8gaHRtbCBib2R5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBNYWlsU2VydmljZSgpLnNlbmRNZXNzYWdlKFwiU2NoZWR1bGVkIE1lc3NhZ2VcIiwgbWFpbE9wdGlvbnNBZG1pbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVE9UQUwgV0FSTklORyBFTUFJTFMgU0VOVDogXCIgKyB0d29NaXNzZWRDbGFzc2VzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUT1RBTCBSRU1PVkFMIEVNQUlMUyBTRU5UOiBcIiArIGZvdXJNaXNzZWRDbGFzc2VzKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbGVjdCBjb3Vyc2VJRCBhbmQgY291cnNlTmFtZSBmcm9tIGFsbCBjb3Vyc2VzIFwiICsgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbGVjdCB1c2VySUQgYW5kIGVtYWlsIGZyb20gYWxsIHVzZXJzIFwiICsgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbGVjdCBhbGwgc3R1ZGVudHMgXCIgKyBlcnIpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2V0IGFsbCBhdHRlbmRhbmNlIFwiICsgZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9XHJcblxyXG59KTtcclxuIl19
