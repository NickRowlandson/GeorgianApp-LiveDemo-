var schedule = require('node-schedule');
var MailService = require("./MailService");
var sql = require('mssql');
var config = require('../config');
//runs every night at 10pm
var attendanceCheck = schedule.scheduleJob('0 34 23 * * *', function () {
    var date = new Date();
    var twoMissedClasses = 0, fourMissedClasses = 0;
    var student;
    try {
        sql.connect(config.db)
            .then(function (connection) {
            new sql.Request(connection)
                .query("SELECT * FROM Attendance ORDER BY date DESC")
                .then(function (attendanceResult) {
                new sql.Request(connection)
                    .query("SELECT userID, firstName, lastName FROM Students")
                    .then(function (studentsResult) {
                    new sql.Request(connection)
                        .query("SELECT userID, email FROM Users")
                        .then(function (usersResult) {
                        new sql.Request(connection)
                            .query("SELECT courseID, courseName FROM Course")
                            .then(function (coursesResult) {
                            var _loop_1 = function (student_1) {
                                userInfo = usersResult.filter(function (x) { return x.userID === student_1.userID; });
                                studentAttendance = attendanceResult.filter(function (x) { return x.userID === student_1.userID; });
                                console.log("# of attendance records for " + student_1.firstName + ": " + studentAttendance.length);
                                function courseBy(array, f) {
                                    var courses = {};
                                    array.forEach(function (o) {
                                        var course = JSON.stringify(f(o));
                                        courses[course] = courses[course] || [];
                                        courses[course].push(o);
                                    });
                                    return Object.keys(courses).map(function (course) {
                                        return courses[course];
                                    });
                                }
                                result = courseBy(studentAttendance, function (item) {
                                    return [item.courseID, item.userID];
                                });
                                var _loop_2 = function (course) {
                                    var _loop_3 = function () {
                                        availableCourses = course.filter(function (x) { return x.fourMissedClassMsg === false; });
                                        if (availableCourses.length >= 4 && course[i + 1] != null && course[i + 2] != null && course[i + 3] != null) {
                                            if (course[i].fourMissedClassMsg === false &&
                                                course[i + 1].fourMissedClassMsg === false &&
                                                course[i + 2].fourMissedClassMsg === false &&
                                                course[i + 3].fourMissedClassMsg === false &&
                                                course[i].attendanceValue === 'A' &&
                                                course[i + 1].attendanceValue === 'A' &&
                                                course[i + 2].attendanceValue === 'A' &&
                                                course[i + 3].attendanceValue === 'A') {
                                                //mark attendance records as reviewed and message sent
                                                course[i].fourMissedClassMsg = true;
                                                course[i + 1].fourMissedClassMsg = true;
                                                course[i + 2].fourMissedClassMsg = true;
                                                course[i + 3].fourMissedClassMsg = true;
                                                course[i].twoMissedClassMsg = true;
                                                course[i + 1].twoMissedClassMsg = true;
                                                course[i + 2].twoMissedClassMsg = true;
                                                course[i + 3].twoMissedClassMsg = true;
                                                courseInfo = coursesResult.filter(function (x) { return x.courseID === course[i].courseID; });
                                                console.log("__________________________________________________________________________________________");
                                                console.log("Four consecutive classes missed by: " + student_1.firstName + " " + student_1.lastName);
                                                console.log("Student ID: " + course[i].userID + " - " + course[i + 1].userID);
                                                console.log("Dates: " + course[i].date + ' & ' + course[i + 1].date + ' & ' + course[i + 2].date + ' & ' + course[i + 3].date);
                                                console.log("Course ID: " + course[i].courseID + " - " + course[i + 1].courseID);
                                                console.log("Email: " + userInfo[0].email);
                                                console.log("__________________________________________________________________________________________");
                                                fourMissedClasses += 1;
                                                var mailOptions_1 = {
                                                    from: 'Academic/Career Preparation <academic.career.prep@gmail.com>',
                                                    to: userInfo[0].email,
                                                    subject: 'Removal from ' + courseInfo[0].courseName,
                                                    text: '',
                                                    html: 'Hi ' + student_1.firstName + ',<br /><br />Our records indicate that you have missed 50% or more of your ' + courseInfo[0].courseName +
                                                        ' classes in the last four weeks. Our policy states that students will be withdrawn when this much time has been missed. Unfortunately, ' +
                                                        'this means that you are being exited from ' + courseInfo[0].courseName + ' class.<br /><br />Please contact me by phone at 705-728-1968, Ext. XXXX or by ' +
                                                        'email at <a>Cheryl.Boyes@GeorgianCollege.ca</a> to complete the necessary paperwork and discuss possible opportunities for returning to the ' +
                                                        courseInfo[0].courseName + ' class at a later date.<br /><br />Regards,<br /><br /><strong>Cheryl Boyes</strong><br /><strong>Academic Upgrading Officer</strong>' +
                                                        '<br />Georgian College| One Georgian Drive | Barrie ON | L4M 3X9' // html body
                                                };
                                                query = "UPDATE Attendance SET fourMissedClassMsg = 'true', twoMissedClassMsg = 'true' WHERE attendanceID IN" +
                                                    " ('" + course[i].attendanceID + "','" + course[i + 1].attendanceID + "','" + course[i + 2].attendanceID + "','" + course[i + 3].attendanceID + "')";
                                                new sql.Request(connection)
                                                    .query(query)
                                                    .then(function (result) {
                                                    new MailService().sendMessage('Four Missed Classes', mailOptions_1);
                                                }).catch(function (err) {
                                                    console.log("Update attendance records: " + err);
                                                });
                                            }
                                        }
                                        if (course.length >= 2 && course[i + 1] != null) {
                                            if (course[i].attendanceValue === 'A' &&
                                                course[i + 1].attendanceValue === 'A' &&
                                                course[i].twoMissedClassMsg === false &&
                                                course[i + 1].twoMissedClassMsg === false) {
                                                //mark attendance records as reviewed and message sent
                                                course[i].twoMissedClassMsg = true;
                                                course[i + 1].twoMissedClassMsg = true;
                                                courseInfo = coursesResult.filter(function (x) { return x.courseID === course[i].courseID; });
                                                console.log("__________________________________________________________________________________________");
                                                console.log("Two consecutive classes have been missed by: " + student_1.firstName + " " + student_1.lastName);
                                                console.log("Student ID: " + course[i].userID + " - " + course[i + 1].userID);
                                                console.log("Dates: " + course[i].date + ' & ' + course[i + 1].date);
                                                console.log("Course ID: " + course[i].courseID + " - " + course[i + 1].courseID);
                                                console.log("Email: " + userInfo[0].email);
                                                console.log("__________________________________________________________________________________________");
                                                twoMissedClasses += 1;
                                                var mailOptions_2 = {
                                                    from: 'Academic/Career Preparation <academic.career.prep@gmail.com>',
                                                    to: userInfo[0].email,
                                                    subject: 'Two Missed ' + courseInfo[0].courseName + ' Classes',
                                                    text: '',
                                                    html: 'Hi ' + student_1.firstName + ',<br /><br />I noticed that you missed the last two consecutive ' + courseInfo[0].courseName + ' classes.' +
                                                        ' I hope everything is okay. Let me know if there is something I can do to help.<br /><br />Please be reminded of our program ' +
                                                        'policy that states students are responsible to notify their instructors when they will be absent. In addition, the policy directs ' +
                                                        'students to arrange for a leave of absence if they need to miss two or more classes in a row. A leave of absence can be arranged with ' +
                                                        'Cheryl Boyes, who can contacted by phone at 705-728-1968, Ext. XXXX or by email at <a>Cheryl.Boyes@GeorgianCollege.ca</a><br /><br />Please ' +
                                                        'get in touch with me as soon as possible. Unfortunately, if I don’t hear from you, and you miss the next two classes, you risk being withdrawn ' +
                                                        'from ' + courseInfo[0].courseName + '.<br /><br />Best Regards,<br /><br /><strong>Joanne Pineda, MA AdEd</strong><br /><strong>Academic Preparation Faculty' +
                                                        '</strong><br /><br />Georgian College| One Georgian Drive | Barrie ON | L4M 3X9' // html body
                                                };
                                                query = "UPDATE Attendance SET twoMissedClassMsg = 'true' WHERE attendanceID IN ('" + course[i].attendanceID + "','" + course[i + 1].attendanceID + "')";
                                                new sql.Request(connection)
                                                    .query(query)
                                                    .then(function (result) {
                                                    new MailService().sendMessage('Two Missed Classes', mailOptions_2);
                                                }).catch(function (err) {
                                                    console.log("Select userID and email from all users " + err);
                                                });
                                            }
                                        }
                                    };
                                    for (var i = 0; i < course.length - 1; i++) {
                                        _loop_3();
                                    }
                                };
                                for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {
                                    var course = result_1[_i];
                                    _loop_2(course);
                                }
                            };
                            var userInfo, studentAttendance, result, availableCourses, courseInfo, query, courseInfo, query;
                            for (var _i = 0, studentsResult_1 = studentsResult; _i < studentsResult_1.length; _i++) {
                                var student_1 = studentsResult_1[_i];
                                _loop_1(student_1);
                            }
                            var mailOptionsAdmin = {
                                from: 'academic.career.prep@gmail.com',
                                to: 'academic.career.prep@gmail.com',
                                subject: 'SCHEDULER ✔',
                                text: '',
                                html: '<b> Hi admin!</b><br  /><br  />There were <strong>' + twoMissedClasses + '</strong> emails sent out due to missed classes today. <br/> There were <strong>' +
                                    fourMissedClasses + '</strong> removals from a course today.' // html body
                            };
                            new MailService().sendMessage("Scheduled Message", mailOptionsAdmin);
                            console.log("TOTAL WARNING EMAILS SENT: " + twoMissedClasses);
                            console.log("TOTAL REMOVAL EMAILS SENT: " + fourMissedClasses);
                        }).catch(function (err) {
                            console.log("Select courseID and courseName from all courses " + err);
                        });
                    }).catch(function (err) {
                        console.log("Select userID and email from all users " + err);
                    });
                }).catch(function (err) {
                    console.log("Select all students " + err);
                });
            }).catch(function (err) {
                console.log("Get all attendance " + err);
            });
        }).catch(function (err) {
            console.log(err);
        });
    }
    catch (err) {
        console.log(err);
    }
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9zcmMvc2VydmljZXMvU2NoZWR1bGVTZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUMxQyxJQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDN0MsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQzNCLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUVsQywwQkFBMEI7QUFDMUIsSUFBSSxlQUFlLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxlQUFlLEVBQUU7SUFDMUQsSUFBSSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUN0QixJQUFJLGdCQUFnQixHQUFHLENBQUMsRUFBRSxpQkFBaUIsR0FBRyxDQUFDLENBQUM7SUFDaEQsSUFBSSxPQUFPLENBQUM7SUFFWixJQUFJLENBQUM7UUFDSCxHQUFHLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7YUFDbkIsSUFBSSxDQUFDLFVBQVMsVUFBVTtZQUN2QixJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO2lCQUN4QixLQUFLLENBQUMsNkNBQTZDLENBQUM7aUJBQ3BELElBQUksQ0FBQyxVQUFTLGdCQUFnQjtnQkFDN0IsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztxQkFDeEIsS0FBSyxDQUFDLGtEQUFrRCxDQUFDO3FCQUN6RCxJQUFJLENBQUMsVUFBUyxjQUFjO29CQUMzQixJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO3lCQUN4QixLQUFLLENBQUMsaUNBQWlDLENBQUM7eUJBQ3hDLElBQUksQ0FBQyxVQUFTLFdBQVc7d0JBQ3hCLElBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7NkJBQ3hCLEtBQUssQ0FBQyx5Q0FBeUMsQ0FBQzs2QkFDaEQsSUFBSSxDQUFDLFVBQVMsYUFBYTtvREFDakIsU0FBTztnQ0FDVixRQUFRLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxNQUFNLEtBQUssU0FBTyxDQUFDLE1BQU0sRUFBM0IsQ0FBMkIsQ0FBQyxDQUFDO2dDQUNoRSxpQkFBaUIsR0FBRyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsTUFBTSxLQUFLLFNBQU8sQ0FBQyxNQUFNLEVBQTNCLENBQTJCLENBQUMsQ0FBQztnQ0FDbEYsT0FBTyxDQUFDLEdBQUcsQ0FBQyw4QkFBOEIsR0FBRyxTQUFPLENBQUMsU0FBUyxHQUFHLElBQUksR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQ0FDbEcsa0JBQWtCLEtBQUssRUFBRSxDQUFDO29DQUN4QixJQUFJLE9BQU8sR0FBRyxFQUFFLENBQUM7b0NBQ2pCLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBUyxDQUFDO3dDQUN0QixJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dDQUNsQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQzt3Q0FDeEMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQ0FDMUIsQ0FBQyxDQUFDLENBQUM7b0NBQ0gsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVMsTUFBTTt3Q0FDN0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztvQ0FDekIsQ0FBQyxDQUFDLENBQUE7Z0NBQ0osQ0FBQztnQ0FDRyxNQUFNLEdBQUcsUUFBUSxDQUFDLGlCQUFpQixFQUFFLFVBQVMsSUFBSTtvQ0FDcEQsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7Z0NBQ3RDLENBQUMsQ0FBQyxDQUFDO3dEQUNNLE1BQU07O3dDQUVQLGdCQUFnQixHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsa0JBQWtCLEtBQUssS0FBSyxFQUE5QixDQUE4QixDQUFDLENBQUM7d0NBQzFFLEVBQUUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUssTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDOzRDQUM3RyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLEtBQUssS0FBSztnREFDeEMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsS0FBSyxLQUFLO2dEQUMxQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixLQUFLLEtBQUs7Z0RBQzFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLEtBQUssS0FBSztnREFDMUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsS0FBSyxHQUFHO2dEQUNqQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGVBQWUsS0FBSyxHQUFHO2dEQUNyQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGVBQWUsS0FBSyxHQUFHO2dEQUNyQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGVBQWUsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO2dEQUN4QyxzREFBc0Q7Z0RBQ3RELE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUM7Z0RBQ3BDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDO2dEQUN4QyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQztnREFDeEMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUM7Z0RBQ3hDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7Z0RBQ25DLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO2dEQUN2QyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQztnREFDdkMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7Z0RBQ25DLFVBQVUsR0FBRyxhQUFhLENBQUMsTUFBTSxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLFFBQVEsS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFqQyxDQUFpQyxDQUFDLENBQUM7Z0RBQzlFLE9BQU8sQ0FBQyxHQUFHLENBQUMsNEZBQTRGLENBQUMsQ0FBQztnREFDMUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQ0FBc0MsR0FBRyxTQUFPLENBQUMsU0FBUyxHQUFHLEdBQUcsR0FBRyxTQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7Z0RBQ2pHLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7Z0RBQzlFLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxLQUFLLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnREFDL0gsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsR0FBRyxLQUFLLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQztnREFDakYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dEQUMzQyxPQUFPLENBQUMsR0FBRyxDQUFDLDRGQUE0RixDQUFDLENBQUM7Z0RBQzFHLGlCQUFpQixJQUFJLENBQUMsQ0FBQztnREFDdkIsSUFBSSxhQUFXLEdBQUc7b0RBQ2hCLElBQUksRUFBRSw4REFBOEQ7b0RBQ3BFLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSztvREFDckIsT0FBTyxFQUFFLGVBQWUsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVTtvREFDbkQsSUFBSSxFQUFFLEVBQUU7b0RBQ1IsSUFBSSxFQUFFLEtBQUssR0FBRyxTQUFPLENBQUMsU0FBUyxHQUFHLDZFQUE2RSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVO3dEQUMxSSx5SUFBeUk7d0RBQ3pJLDRDQUE0QyxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEdBQUcsaUZBQWlGO3dEQUMzSiw4SUFBOEk7d0RBQzlJLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEdBQUcsdUlBQXVJO3dEQUNsSyxrRUFBa0UsQ0FBQyxZQUFZO2lEQUNoRixDQUFDO2dEQUNFLEtBQUssR0FBRyxxR0FBcUc7b0RBQ2pILEtBQUssR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxHQUFFLEtBQUssR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksR0FBRSxLQUFLLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLEdBQUUsS0FBSyxHQUFHLE1BQU0sQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxHQUFFLElBQUksQ0FBQztnREFDM0ksSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztxREFDeEIsS0FBSyxDQUFDLEtBQUssQ0FBQztxREFDWixJQUFJLENBQUMsVUFBUyxNQUFNO29EQUNuQixJQUFJLFdBQVcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsRUFBRSxhQUFXLENBQUMsQ0FBQztnREFDcEUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsR0FBRztvREFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsR0FBRyxHQUFHLENBQUMsQ0FBQztnREFDbkQsQ0FBQyxDQUFDLENBQUM7NENBQ1AsQ0FBQzt3Q0FDSCxDQUFDO3dDQUNELEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLElBQUksQ0FBQyxJQUFJLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQzs0Q0FDaEQsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsS0FBSyxHQUFHO2dEQUNuQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLGVBQWUsS0FBSyxHQUFHO2dEQUNyQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLEtBQUssS0FBSztnREFDckMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dEQUM1QyxzREFBc0Q7Z0RBQ3RELE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7Z0RBQ25DLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO2dEQUNuQyxVQUFVLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxRQUFRLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBakMsQ0FBaUMsQ0FBQyxDQUFDO2dEQUM5RSxPQUFPLENBQUMsR0FBRyxDQUFDLDRGQUE0RixDQUFDLENBQUM7Z0RBQzFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsK0NBQStDLEdBQUcsU0FBTyxDQUFDLFNBQVMsR0FBRyxHQUFHLEdBQUcsU0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dEQUMxRyxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dEQUM5RSxPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO2dEQUNyRSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dEQUNqRixPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7Z0RBQzNDLE9BQU8sQ0FBQyxHQUFHLENBQUMsNEZBQTRGLENBQUMsQ0FBQztnREFDMUcsZ0JBQWdCLElBQUksQ0FBQyxDQUFDO2dEQUN0QixJQUFJLGFBQVcsR0FBRztvREFDaEIsSUFBSSxFQUFFLDhEQUE4RDtvREFDcEUsRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLO29EQUNyQixPQUFPLEVBQUUsYUFBYSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEdBQUcsVUFBVTtvREFDOUQsSUFBSSxFQUFFLEVBQUU7b0RBQ1IsSUFBSSxFQUFFLEtBQUssR0FBRyxTQUFPLENBQUMsU0FBUyxHQUFHLGtFQUFrRSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEdBQUcsV0FBVzt3REFDN0ksK0hBQStIO3dEQUMvSCxvSUFBb0k7d0RBQ3BJLHdJQUF3STt3REFDeEksOElBQThJO3dEQUM5SSxpSkFBaUo7d0RBQ2pKLE9BQU8sR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxHQUFHLHlIQUF5SDt3REFDOUosaUZBQWlGLENBQUMsWUFBWTtpREFDL0YsQ0FBQztnREFDRSxLQUFLLEdBQUcsMkVBQTJFLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksR0FBRSxLQUFLLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLEdBQUUsSUFBSSxDQUFDO2dEQUN6SixJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO3FEQUN4QixLQUFLLENBQUMsS0FBSyxDQUFDO3FEQUNaLElBQUksQ0FBQyxVQUFTLE1BQU07b0RBQ25CLElBQUksV0FBVyxFQUFFLENBQUMsV0FBVyxDQUFDLG9CQUFvQixFQUFFLGFBQVcsQ0FBQyxDQUFDO2dEQUNuRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBUyxHQUFHO29EQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLHlDQUF5QyxHQUFHLEdBQUcsQ0FBQyxDQUFDO2dEQUMvRCxDQUFDLENBQUMsQ0FBQzs0Q0FDUCxDQUFDO3dDQUNILENBQUM7b0NBQ0gsQ0FBQztvQ0E3RkQsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxHQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7O3FDQTZGdkM7Z0NBQ0gsQ0FBQztnQ0EvRkQsR0FBRyxDQUFDLENBQWUsVUFBTSxFQUFOLGlCQUFNLEVBQU4sb0JBQU0sRUFBTixJQUFNO29DQUFwQixJQUFJLE1BQU0sZUFBQTs0Q0FBTixNQUFNO2lDQStGZDs0QkFDSCxDQUFDO2dDQWpISyxRQUFRLEVBQ1IsaUJBQWlCLEVBYWpCLE1BQU0sRUFLRixnQkFBZ0IsRUFtQlosVUFBVSxFQXFCVixLQUFLLEVBbUJMLFVBQVUsRUF1QlYsS0FBSzs0QkF0R25CLEdBQUcsQ0FBQyxDQUFnQixVQUFjLEVBQWQsaUNBQWMsRUFBZCw0QkFBYyxFQUFkLElBQWM7Z0NBQTdCLElBQUksU0FBTyx1QkFBQTt3Q0FBUCxTQUFPOzZCQWtIZjs0QkFDRCxJQUFJLGdCQUFnQixHQUFHO2dDQUNyQixJQUFJLEVBQUUsZ0NBQWdDO2dDQUN0QyxFQUFFLEVBQUUsZ0NBQWdDO2dDQUNwQyxPQUFPLEVBQUUsYUFBYTtnQ0FDdEIsSUFBSSxFQUFFLEVBQUU7Z0NBQ1IsSUFBSSxFQUFFLG9EQUFvRCxHQUFHLGdCQUFnQixHQUFHLGtGQUFrRjtvQ0FDbEssaUJBQWlCLEdBQUcseUNBQXlDLENBQUMsWUFBWTs2QkFDM0UsQ0FBQzs0QkFDRixJQUFJLFdBQVcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxtQkFBbUIsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDOzRCQUNyRSxPQUFPLENBQUMsR0FBRyxDQUFDLDZCQUE2QixHQUFHLGdCQUFnQixDQUFDLENBQUM7NEJBQzlELE9BQU8sQ0FBQyxHQUFHLENBQUMsNkJBQTZCLEdBQUcsaUJBQWlCLENBQUMsQ0FBQzt3QkFDakUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsR0FBRzs0QkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrREFBa0QsR0FBRyxHQUFHLENBQUMsQ0FBQzt3QkFDeEUsQ0FBQyxDQUFDLENBQUM7b0JBQ1AsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsR0FBRzt3QkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyx5Q0FBeUMsR0FBRyxHQUFHLENBQUMsQ0FBQztvQkFDL0QsQ0FBQyxDQUFDLENBQUM7Z0JBQ1AsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsR0FBRztvQkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsR0FBRyxHQUFHLENBQUMsQ0FBQztnQkFDNUMsQ0FBQyxDQUFDLENBQUM7WUFDUCxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBUyxHQUFHO2dCQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixHQUFHLEdBQUcsQ0FBQyxDQUFDO1lBQzNDLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsR0FBRztZQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ25CLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDWCxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ25CLENBQUM7QUFFSCxDQUFDLENBQUMsQ0FBQyIsImZpbGUiOiJzZXJ2aWNlcy9TY2hlZHVsZVNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzY2hlZHVsZSA9IHJlcXVpcmUoJ25vZGUtc2NoZWR1bGUnKTtcclxuY29uc3QgTWFpbFNlcnZpY2UgPSByZXF1aXJlKFwiLi9NYWlsU2VydmljZVwiKTtcclxudmFyIHNxbCA9IHJlcXVpcmUoJ21zc3FsJyk7XHJcbnZhciBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcnKTtcclxuXHJcbi8vcnVucyBldmVyeSBuaWdodCBhdCAxMHBtXHJcbnZhciBhdHRlbmRhbmNlQ2hlY2sgPSBzY2hlZHVsZS5zY2hlZHVsZUpvYignMCAzNCAyMyAqICogKicsIGZ1bmN0aW9uKCkge1xyXG4gIHZhciBkYXRlID0gbmV3IERhdGUoKTtcclxuICB2YXIgdHdvTWlzc2VkQ2xhc3NlcyA9IDAsIGZvdXJNaXNzZWRDbGFzc2VzID0gMDtcclxuICB2YXIgc3R1ZGVudDtcclxuXHJcbiAgdHJ5IHtcclxuICAgIHNxbC5jb25uZWN0KGNvbmZpZy5kYilcclxuICAgICAgLnRoZW4oZnVuY3Rpb24oY29ubmVjdGlvbikge1xyXG4gICAgICAgIG5ldyBzcWwuUmVxdWVzdChjb25uZWN0aW9uKVxyXG4gICAgICAgICAgLnF1ZXJ5KFwiU0VMRUNUICogRlJPTSBBdHRlbmRhbmNlIE9SREVSIEJZIGRhdGUgREVTQ1wiKVxyXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oYXR0ZW5kYW5jZVJlc3VsdCkge1xyXG4gICAgICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgICAgICAucXVlcnkoXCJTRUxFQ1QgdXNlcklELCBmaXJzdE5hbWUsIGxhc3ROYW1lIEZST00gU3R1ZGVudHNcIilcclxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihzdHVkZW50c1Jlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgbmV3IHNxbC5SZXF1ZXN0KGNvbm5lY3Rpb24pXHJcbiAgICAgICAgICAgICAgICAgIC5xdWVyeShcIlNFTEVDVCB1c2VySUQsIGVtYWlsIEZST00gVXNlcnNcIilcclxuICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24odXNlcnNSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgIC5xdWVyeShcIlNFTEVDVCBjb3Vyc2VJRCwgY291cnNlTmFtZSBGUk9NIENvdXJzZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oY291cnNlc1Jlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBzdHVkZW50IG9mIHN0dWRlbnRzUmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJbmZvID0gdXNlcnNSZXN1bHQuZmlsdGVyKHggPT4geC51c2VySUQgPT09IHN0dWRlbnQudXNlcklEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3R1ZGVudEF0dGVuZGFuY2UgPSBhdHRlbmRhbmNlUmVzdWx0LmZpbHRlcih4ID0+IHgudXNlcklEID09PSBzdHVkZW50LnVzZXJJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIjIG9mIGF0dGVuZGFuY2UgcmVjb3JkcyBmb3IgXCIgKyBzdHVkZW50LmZpcnN0TmFtZSArIFwiOiBcIiArIHN0dWRlbnRBdHRlbmRhbmNlLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY291cnNlQnkoYXJyYXksIGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3Vyc2VzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdXJzZSA9IEpTT04uc3RyaW5naWZ5KGYobykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VzW2NvdXJzZV0gPSBjb3Vyc2VzW2NvdXJzZV0gfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZXNbY291cnNlXS5wdXNoKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoY291cnNlcykubWFwKGZ1bmN0aW9uKGNvdXJzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY291cnNlc1tjb3Vyc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGNvdXJzZUJ5KHN0dWRlbnRBdHRlbmRhbmNlLCBmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2l0ZW0uY291cnNlSUQsIGl0ZW0udXNlcklEXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjb3Vyc2Ugb2YgcmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdXJzZS5sZW5ndGgtMTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmFpbGFibGVDb3Vyc2VzID0gY291cnNlLmZpbHRlcih4ID0+IHguZm91ck1pc3NlZENsYXNzTXNnID09PSBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdmFpbGFibGVDb3Vyc2VzLmxlbmd0aCA+PSA0ICAmJiBjb3Vyc2VbaSArIDFdICE9IG51bGwgJiYgY291cnNlW2kgKyAyXSAhPSBudWxsICYmIGNvdXJzZVtpICsgM10gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3Vyc2VbaV0uZm91ck1pc3NlZENsYXNzTXNnID09PSBmYWxzZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPT09IGZhbHNlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDJdLmZvdXJNaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgM10uZm91ck1pc3NlZENsYXNzTXNnID09PSBmYWxzZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2ldLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDFdLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDJdLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDNdLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL21hcmsgYXR0ZW5kYW5jZSByZWNvcmRzIGFzIHJldmlld2VkIGFuZCBtZXNzYWdlIHNlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAyXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAzXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2ldLnR3b01pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0udHdvTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAyXS50d29NaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDNdLnR3b01pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3Vyc2VJbmZvID0gY291cnNlc1Jlc3VsdC5maWx0ZXIoeCA9PiB4LmNvdXJzZUlEID09PSBjb3Vyc2VbaV0uY291cnNlSUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZvdXIgY29uc2VjdXRpdmUgY2xhc3NlcyBtaXNzZWQgYnk6IFwiICsgc3R1ZGVudC5maXJzdE5hbWUgKyBcIiBcIiArIHN0dWRlbnQubGFzdE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdHVkZW50IElEOiBcIiArIGNvdXJzZVtpXS51c2VySUQgKyBcIiAtIFwiICsgY291cnNlW2kgKyAxXS51c2VySUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRlczogXCIgKyBjb3Vyc2VbaV0uZGF0ZSArICcgJiAnICsgY291cnNlW2kgKyAxXS5kYXRlICsgJyAmICcgKyBjb3Vyc2VbaSArIDJdLmRhdGUgKyAnICYgJyArIGNvdXJzZVtpICsgM10uZGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvdXJzZSBJRDogXCIgKyBjb3Vyc2VbaV0uY291cnNlSUQgKyBcIiAtIFwiICsgY291cnNlW2kgKyAxXS5jb3Vyc2VJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVtYWlsOiBcIiArIHVzZXJJbmZvWzBdLmVtYWlsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91ck1pc3NlZENsYXNzZXMgKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYWlsT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ0FjYWRlbWljL0NhcmVlciBQcmVwYXJhdGlvbiA8YWNhZGVtaWMuY2FyZWVyLnByZXBAZ21haWwuY29tPicsIC8vIHNlbmRlciBhZGRyZXNzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvOiB1c2VySW5mb1swXS5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdDogJ1JlbW92YWwgZnJvbSAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lLCAvLyBTdWJqZWN0IGxpbmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJycsIC8vIHBsYWluIHRleHQgYm9keVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sOiAnSGkgJyArIHN0dWRlbnQuZmlyc3ROYW1lICsgJyw8YnIgLz48YnIgLz5PdXIgcmVjb3JkcyBpbmRpY2F0ZSB0aGF0IHlvdSBoYXZlIG1pc3NlZCA1MCUgb3IgbW9yZSBvZiB5b3VyICcgKyBjb3Vyc2VJbmZvWzBdLmNvdXJzZU5hbWUgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIGNsYXNzZXMgaW4gdGhlIGxhc3QgZm91ciB3ZWVrcy4gT3VyIHBvbGljeSBzdGF0ZXMgdGhhdCBzdHVkZW50cyB3aWxsIGJlIHdpdGhkcmF3biB3aGVuIHRoaXMgbXVjaCB0aW1lIGhhcyBiZWVuIG1pc3NlZC4gVW5mb3J0dW5hdGVseSwgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aGlzIG1lYW5zIHRoYXQgeW91IGFyZSBiZWluZyBleGl0ZWQgZnJvbSAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lICsgJyBjbGFzcy48YnIgLz48YnIgLz5QbGVhc2UgY29udGFjdCBtZSBieSBwaG9uZSBhdCA3MDUtNzI4LTE5NjgsIEV4dC4gWFhYWCBvciBieSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VtYWlsIGF0IDxhPkNoZXJ5bC5Cb3llc0BHZW9yZ2lhbkNvbGxlZ2UuY2E8L2E+IHRvIGNvbXBsZXRlIHRoZSBuZWNlc3NhcnkgcGFwZXJ3b3JrIGFuZCBkaXNjdXNzIHBvc3NpYmxlIG9wcG9ydHVuaXRpZXMgZm9yIHJldHVybmluZyB0byB0aGUgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArICcgY2xhc3MgYXQgYSBsYXRlciBkYXRlLjxiciAvPjxiciAvPlJlZ2FyZHMsPGJyIC8+PGJyIC8+PHN0cm9uZz5DaGVyeWwgQm95ZXM8L3N0cm9uZz48YnIgLz48c3Ryb25nPkFjYWRlbWljIFVwZ3JhZGluZyBPZmZpY2VyPC9zdHJvbmc+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YnIgLz5HZW9yZ2lhbiBDb2xsZWdlfCBPbmUgR2VvcmdpYW4gRHJpdmUgfCBCYXJyaWUgT04gfCBMNE0gM1g5JyAvLyBodG1sIGJvZHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSBcIlVQREFURSBBdHRlbmRhbmNlIFNFVCBmb3VyTWlzc2VkQ2xhc3NNc2cgPSAndHJ1ZScsIHR3b01pc3NlZENsYXNzTXNnID0gJ3RydWUnIFdIRVJFIGF0dGVuZGFuY2VJRCBJTlwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiICgnXCIgKyBjb3Vyc2VbaV0uYXR0ZW5kYW5jZUlEICtcIicsJ1wiICsgY291cnNlW2krMV0uYXR0ZW5kYW5jZUlEICtcIicsJ1wiICsgY291cnNlW2krMl0uYXR0ZW5kYW5jZUlEICtcIicsJ1wiICsgY291cnNlW2krM10uYXR0ZW5kYW5jZUlEICtcIicpXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5KHF1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFpbFNlcnZpY2UoKS5zZW5kTWVzc2FnZSgnRm91ciBNaXNzZWQgQ2xhc3NlcycsIG1haWxPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVcGRhdGUgYXR0ZW5kYW5jZSByZWNvcmRzOiBcIiArIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291cnNlLmxlbmd0aCA+PSAyICYmIGNvdXJzZVtpICsgMV0gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3Vyc2VbaV0uYXR0ZW5kYW5jZVZhbHVlID09PSAnQScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0uYXR0ZW5kYW5jZVZhbHVlID09PSAnQScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS50d29NaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0udHdvTWlzc2VkQ2xhc3NNc2cgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL21hcmsgYXR0ZW5kYW5jZSByZWNvcmRzIGFzIHJldmlld2VkIGFuZCBtZXNzYWdlIHNlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS50d29NaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDFdLnR3b01pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3Vyc2VJbmZvID0gY291cnNlc1Jlc3VsdC5maWx0ZXIoeCA9PiB4LmNvdXJzZUlEID09PSBjb3Vyc2VbaV0uY291cnNlSUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlR3byBjb25zZWN1dGl2ZSBjbGFzc2VzIGhhdmUgYmVlbiBtaXNzZWQgYnk6IFwiICsgc3R1ZGVudC5maXJzdE5hbWUgKyBcIiBcIiArIHN0dWRlbnQubGFzdE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdHVkZW50IElEOiBcIiArIGNvdXJzZVtpXS51c2VySUQgKyBcIiAtIFwiICsgY291cnNlW2kgKyAxXS51c2VySUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEYXRlczogXCIgKyBjb3Vyc2VbaV0uZGF0ZSArICcgJiAnICsgY291cnNlW2kgKyAxXS5kYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ291cnNlIElEOiBcIiArIGNvdXJzZVtpXS5jb3Vyc2VJRCArIFwiIC0gXCIgKyBjb3Vyc2VbaSArIDFdLmNvdXJzZUlEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRW1haWw6IFwiICsgdXNlckluZm9bMF0uZW1haWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0d29NaXNzZWRDbGFzc2VzICs9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWFpbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdBY2FkZW1pYy9DYXJlZXIgUHJlcGFyYXRpb24gPGFjYWRlbWljLmNhcmVlci5wcmVwQGdtYWlsLmNvbT4nLCAvLyBzZW5kZXIgYWRkcmVzc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogdXNlckluZm9bMF0uZW1haWwsIC8vIHN0dWRlbnQuZW1haWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdDogJ1R3byBNaXNzZWQgJyArIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArICcgQ2xhc3NlcycsIC8vIFN1YmplY3QgbGluZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnJywgLy8gcGxhaW4gdGV4dCBib2R5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWw6ICdIaSAnICsgc3R1ZGVudC5maXJzdE5hbWUgKyAnLDxiciAvPjxiciAvPkkgbm90aWNlZCB0aGF0IHlvdSBtaXNzZWQgdGhlIGxhc3QgdHdvIGNvbnNlY3V0aXZlICcgKyBjb3Vyc2VJbmZvWzBdLmNvdXJzZU5hbWUgKyAnIGNsYXNzZXMuJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgSSBob3BlIGV2ZXJ5dGhpbmcgaXMgb2theS4gTGV0IG1lIGtub3cgaWYgdGhlcmUgaXMgc29tZXRoaW5nIEkgY2FuIGRvIHRvIGhlbHAuPGJyIC8+PGJyIC8+UGxlYXNlIGJlIHJlbWluZGVkIG9mIG91ciBwcm9ncmFtICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncG9saWN5IHRoYXQgc3RhdGVzIHN0dWRlbnRzIGFyZSByZXNwb25zaWJsZSB0byBub3RpZnkgdGhlaXIgaW5zdHJ1Y3RvcnMgd2hlbiB0aGV5IHdpbGwgYmUgYWJzZW50LiBJbiBhZGRpdGlvbiwgdGhlIHBvbGljeSBkaXJlY3RzICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3R1ZGVudHMgdG8gYXJyYW5nZSBmb3IgYSBsZWF2ZSBvZiBhYnNlbmNlIGlmIHRoZXkgbmVlZCB0byBtaXNzIHR3byBvciBtb3JlIGNsYXNzZXMgaW4gYSByb3cuIEEgbGVhdmUgb2YgYWJzZW5jZSBjYW4gYmUgYXJyYW5nZWQgd2l0aCAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NoZXJ5bCBCb3llcywgd2hvIGNhbiBjb250YWN0ZWQgYnkgcGhvbmUgYXQgNzA1LTcyOC0xOTY4LCBFeHQuIFhYWFggb3IgYnkgZW1haWwgYXQgPGE+Q2hlcnlsLkJveWVzQEdlb3JnaWFuQ29sbGVnZS5jYTwvYT48YnIgLz48YnIgLz5QbGVhc2UgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdnZXQgaW4gdG91Y2ggd2l0aCBtZSBhcyBzb29uIGFzIHBvc3NpYmxlLiBVbmZvcnR1bmF0ZWx5LCBpZiBJIGRvbuKAmXQgaGVhciBmcm9tIHlvdSwgYW5kIHlvdSBtaXNzIHRoZSBuZXh0IHR3byBjbGFzc2VzLCB5b3UgcmlzayBiZWluZyB3aXRoZHJhd24gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmcm9tICcgKyBjb3Vyc2VJbmZvWzBdLmNvdXJzZU5hbWUgKyAnLjxiciAvPjxiciAvPkJlc3QgUmVnYXJkcyw8YnIgLz48YnIgLz48c3Ryb25nPkpvYW5uZSBQaW5lZGEsIE1BIEFkRWQ8L3N0cm9uZz48YnIgLz48c3Ryb25nPkFjYWRlbWljIFByZXBhcmF0aW9uIEZhY3VsdHknICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvc3Ryb25nPjxiciAvPjxiciAvPkdlb3JnaWFuIENvbGxlZ2V8IE9uZSBHZW9yZ2lhbiBEcml2ZSB8IEJhcnJpZSBPTiB8IEw0TSAzWDknIC8vIGh0bWwgYm9keVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IFwiVVBEQVRFIEF0dGVuZGFuY2UgU0VUIHR3b01pc3NlZENsYXNzTXNnID0gJ3RydWUnIFdIRVJFIGF0dGVuZGFuY2VJRCBJTiAoJ1wiICsgY291cnNlW2ldLmF0dGVuZGFuY2VJRCArXCInLCdcIiArIGNvdXJzZVtpKzFdLmF0dGVuZGFuY2VJRCArXCInKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IHNxbC5SZXF1ZXN0KGNvbm5lY3Rpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5xdWVyeShxdWVyeSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE1haWxTZXJ2aWNlKCkuc2VuZE1lc3NhZ2UoJ1R3byBNaXNzZWQgQ2xhc3NlcycsIG1haWxPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3QgdXNlcklEIGFuZCBlbWFpbCBmcm9tIGFsbCB1c2VycyBcIiArIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWFpbE9wdGlvbnNBZG1pbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnYWNhZGVtaWMuY2FyZWVyLnByZXBAZ21haWwuY29tJywgLy8gc2VuZGVyIGFkZHJlc3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogJ2FjYWRlbWljLmNhcmVlci5wcmVwQGdtYWlsLmNvbScsIC8vIGxpc3Qgb2YgcmVjZWl2ZXJzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdDogJ1NDSEVEVUxFUiDinJQnLCAvLyBTdWJqZWN0IGxpbmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnJywgLy8gcGxhaW4gdGV4dCBib2R5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbDogJzxiPiBIaSBhZG1pbiE8L2I+PGJyICAvPjxiciAgLz5UaGVyZSB3ZXJlIDxzdHJvbmc+JyArIHR3b01pc3NlZENsYXNzZXMgKyAnPC9zdHJvbmc+IGVtYWlscyBzZW50IG91dCBkdWUgdG8gbWlzc2VkIGNsYXNzZXMgdG9kYXkuIDxici8+IFRoZXJlIHdlcmUgPHN0cm9uZz4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VyTWlzc2VkQ2xhc3NlcyArICc8L3N0cm9uZz4gcmVtb3ZhbHMgZnJvbSBhIGNvdXJzZSB0b2RheS4nIC8vIGh0bWwgYm9keVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFpbFNlcnZpY2UoKS5zZW5kTWVzc2FnZShcIlNjaGVkdWxlZCBNZXNzYWdlXCIsIG1haWxPcHRpb25zQWRtaW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRPVEFMIFdBUk5JTkcgRU1BSUxTIFNFTlQ6IFwiICsgdHdvTWlzc2VkQ2xhc3Nlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVE9UQUwgUkVNT1ZBTCBFTUFJTFMgU0VOVDogXCIgKyBmb3VyTWlzc2VkQ2xhc3Nlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3QgY291cnNlSUQgYW5kIGNvdXJzZU5hbWUgZnJvbSBhbGwgY291cnNlcyBcIiArIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3QgdXNlcklEIGFuZCBlbWFpbCBmcm9tIGFsbCB1c2VycyBcIiArIGVycik7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3QgYWxsIHN0dWRlbnRzIFwiICsgZXJyKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBhbGwgYXR0ZW5kYW5jZSBcIiArIGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4gIGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfVxyXG5cclxufSk7XHJcbiJdfQ==
