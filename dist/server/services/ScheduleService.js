const schedule = require('node-schedule');
const MailService = require("./MailService");
const ActivityService = require("./ActivityService");
var sql = require('mssql');
var config = require('../config');
//runs every night at 7:30pm
var attendanceCheck = schedule.scheduleJob('0 36 16 * * *', function () {
    var date = new Date();
    var twoMissedClasses = 0, fourMissedClasses = 0;
    var student;
    try {
        sql.connect(config.db)
            .then(function (connection) {
            new sql.Request(connection)
                .query("SELECT * FROM Attendance ORDER BY date DESC")
                .then(function (attendanceResult) {
                new sql.Request(connection)
                    .query("SELECT userID, firstName, lastName FROM Students")
                    .then(function (studentsResult) {
                    new sql.Request(connection)
                        .query("SELECT userID, email FROM Users")
                        .then(function (usersResult) {
                        new sql.Request(connection)
                            .query("SELECT courseID, courseName FROM Course")
                            .then(function (coursesResult) {
                            for (let student of studentsResult) {
                                var userInfo = usersResult.filter(x => x.userID === student.userID);
                                var studentAttendance = attendanceResult.filter(x => x.userID === student.userID);
                                console.log("# of attendance records for " + student.firstName + ": " + studentAttendance.length);
                                function courseBy(array, f) {
                                    var courses = {};
                                    array.forEach(function (o) {
                                        var course = JSON.stringify(f(o));
                                        courses[course] = courses[course] || [];
                                        courses[course].push(o);
                                    });
                                    return Object.keys(courses).map(function (course) {
                                        return courses[course];
                                    });
                                }
                                var result = courseBy(studentAttendance, function (item) {
                                    return [item.courseID, item.userID];
                                });
                                for (let course of result) {
                                    for (var i = 0; i < course.length - 1; i++) {
                                        var availableCourses = course.filter(x => x.fourMissedClassMsg === false);
                                        if (availableCourses.length >= 4 && course[i + 1] != null && course[i + 2] != null && course[i + 3] != null) {
                                            if (course[i].fourMissedClassMsg === false &&
                                                course[i + 1].fourMissedClassMsg === false &&
                                                course[i + 2].fourMissedClassMsg === false &&
                                                course[i + 3].fourMissedClassMsg === false &&
                                                course[i].attendanceValue === 'A' &&
                                                course[i + 1].attendanceValue === 'A' &&
                                                course[i + 2].attendanceValue === 'A' &&
                                                course[i + 3].attendanceValue === 'A') {
                                                //mark attendance records as reviewed and message sent
                                                course[i].fourMissedClassMsg = true;
                                                course[i + 1].fourMissedClassMsg = true;
                                                course[i + 2].fourMissedClassMsg = true;
                                                course[i + 3].fourMissedClassMsg = true;
                                                course[i].twoMissedClassMsg = true;
                                                course[i + 1].twoMissedClassMsg = true;
                                                course[i + 2].twoMissedClassMsg = true;
                                                course[i + 3].twoMissedClassMsg = true;
                                                var courseInfo = coursesResult.filter(x => x.courseID === course[i].courseID);
                                                console.log("__________________________________________________________________________________________");
                                                console.log("Four consecutive classes missed by: " + student.firstName + " " + student.lastName);
                                                console.log("Student ID: " + course[i].userID + " - " + course[i + 1].userID);
                                                console.log("Dates: " + course[i].date + ' & ' + course[i + 1].date + ' & ' + course[i + 2].date + ' & ' + course[i + 3].date);
                                                console.log("Course ID: " + course[i].courseID + " - " + course[i + 1].courseID);
                                                console.log("Email: " + userInfo[0].email);
                                                console.log("__________________________________________________________________________________________");
                                                fourMissedClasses += 1;
                                                let mailOptions = {
                                                    from: config.mail.user,
                                                    to: userInfo[0].email,
                                                    subject: 'Removal from ' + courseInfo[0].courseName,
                                                    text: '',
                                                    html: 'Hi ' + student.firstName + ',<br /><br />Our records indicate that you have missed 50% or more of your ' + courseInfo[0].courseName +
                                                        ' classes in the last four weeks. Our policy states that students will be withdrawn when this much time has been missed. Unfortunately, ' +
                                                        'this means that you are being exited from ' + courseInfo[0].courseName + ' class.<br /><br />Please contact me by phone at 705-728-1968, Ext. XXXX or by ' +
                                                        'email at <a>Cheryl.Boyes@GeorgianCollege.ca</a> to complete the necessary paperwork and discuss possible opportunities for returning to the ' +
                                                        courseInfo[0].courseName + ' class at a later date.<br /><br />Regards,<br /><br /><strong>Cheryl Boyes</strong><br /><strong>Academic Upgrading Officer</strong>' +
                                                        '<br />Georgian College| One Georgian Drive | Barrie ON | L4M 3X9' // html body
                                                };
                                                var query = "UPDATE Attendance SET fourMissedClassMsg = 'true', twoMissedClassMsg = 'true' WHERE attendanceID IN" +
                                                    " ('" + course[i].attendanceID + "','" + course[i + 1].attendanceID + "','" + course[i + 2].attendanceID + "','" + course[i + 3].attendanceID + "')";
                                                new sql.Request(connection)
                                                    .query(query)
                                                    .then(function (result) {
                                                    new MailService().sendMessage('Four Missed Classes', mailOptions);
                                                    new ActivityService().reportActivity('scheduledEmails', 'Four Missed Classes', 'success', student.userID, '', student.firstName + ' ' + student.lastName + ' has missed four consecutive classes for the following course: ' + courseInfo[0].courseName);
                                                }).catch(function (err) {
                                                    console.log("Update attendance records: " + err);
                                                });
                                            }
                                        }
                                        if (course.length >= 2 && course[i + 1] != null) {
                                            if (course[i].attendanceValue === 'A' &&
                                                course[i + 1].attendanceValue === 'A' &&
                                                course[i].twoMissedClassMsg === false &&
                                                course[i + 1].twoMissedClassMsg === false) {
                                                //mark attendance records as reviewed and message sent
                                                course[i].twoMissedClassMsg = true;
                                                course[i + 1].twoMissedClassMsg = true;
                                                var courseInfo = coursesResult.filter(x => x.courseID === course[i].courseID);
                                                console.log("__________________________________________________________________________________________");
                                                console.log("Two consecutive classes have been missed by: " + student.firstName + " " + student.lastName);
                                                console.log("Student ID: " + student.userID);
                                                console.log("Dates: " + course[i].date + ' & ' + course[i + 1].date);
                                                console.log("Course ID: " + course[i].courseID + " - " + course[i + 1].courseID);
                                                console.log("Email: " + userInfo[0].email);
                                                console.log("__________________________________________________________________________________________");
                                                twoMissedClasses += 1;
                                                let mailOptions = {
                                                    from: config.mail.user,
                                                    to: userInfo[0].email,
                                                    subject: 'Two Missed ' + courseInfo[0].courseName + ' Classes',
                                                    text: '',
                                                    html: 'Hi ' + student.firstName + ',<br /><br />I noticed that you missed the last two consecutive ' + courseInfo[0].courseName + ' classes.' +
                                                        ' I hope everything is okay. Let me know if there is something I can do to help.<br /><br />Please be reminded of our program ' +
                                                        'policy that states students are responsible to notify their instructors when they will be absent. In addition, the policy directs ' +
                                                        'students to arrange for a leave of absence if they need to miss two or more classes in a row. A leave of absence can be arranged with ' +
                                                        'Cheryl Boyes, who can contacted by phone at 705-728-1968, Ext. XXXX or by email at <a>Cheryl.Boyes@GeorgianCollege.ca</a><br /><br />Please ' +
                                                        'get in touch with me as soon as possible. Unfortunately, if I don’t hear from you, and you miss the next two classes, you risk being withdrawn ' +
                                                        'from ' + courseInfo[0].courseName + '.<br /><br />Best Regards,<br /><br /><strong>Joanne Pineda, MA AdEd</strong><br /><strong>Academic Preparation Faculty' +
                                                        '</strong><br /><br />Georgian College| One Georgian Drive | Barrie ON | L4M 3X9' // html body
                                                };
                                                var query = "UPDATE Attendance SET twoMissedClassMsg = 'true' WHERE attendanceID IN ('" + course[i].attendanceID + "','" + course[i + 1].attendanceID + "')";
                                                new sql.Request(connection)
                                                    .query(query)
                                                    .then(function (result) {
                                                    new MailService().sendMessage('Two Missed Classes', mailOptions);
                                                    new ActivityService().reportActivity('scheduledEmails', 'Two Missed Classes', 'success', student.userID, '', student.firstName + ' ' + student.lastName + ' has missed two consecutive classes for the following course: ' + courseInfo[0].courseName);
                                                }).catch(function (err) {
                                                    console.log("Select userID and email from all users " + err);
                                                });
                                            }
                                        }
                                    }
                                }
                            }
                            let mailOptionsAdmin = {
                                from: 'academic.career.prep@gmail.com',
                                to: 'academic.career.prep@gmail.com',
                                subject: 'SCHEDULER ✔',
                                text: '',
                                html: '<b> Hi admin!</b><br  /><br  />There were <strong>' + twoMissedClasses + '</strong> emails sent out due to missed classes today. <br/> There were <strong>' +
                                    fourMissedClasses + '</strong> removals from a course today.' // html body
                            };
                            new MailService().sendMessage("Scheduled Message", mailOptionsAdmin);
                            console.log("TOTAL WARNING EMAILS SENT: " + twoMissedClasses);
                            console.log("TOTAL REMOVAL EMAILS SENT: " + fourMissedClasses);
                        }).catch(function (err) {
                            console.log("Select courseID and courseName from all courses " + err);
                        });
                    }).catch(function (err) {
                        console.log("Select userID and email from all users " + err);
                    });
                }).catch(function (err) {
                    console.log("Select all students " + err);
                });
            }).catch(function (err) {
                console.log("Get all attendance " + err);
            });
        }).catch(function (err) {
            console.log(err);
        });
    }
    catch (err) {
        console.log(err);
    }
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9zcmMvc2VydmljZXMvU2NoZWR1bGVTZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUMxQyxNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDN0MsTUFBTSxlQUFlLEdBQUcsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFDckQsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQzNCLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUVsQyw0QkFBNEI7QUFDNUIsSUFBSSxlQUFlLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxlQUFlLEVBQUU7SUFDNUQsSUFBSSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUN0QixJQUFJLGdCQUFnQixHQUFHLENBQUMsRUFBRSxpQkFBaUIsR0FBRyxDQUFDLENBQUM7SUFDaEQsSUFBSSxPQUFPLENBQUM7SUFFWixJQUFJO1FBQ0YsR0FBRyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO2FBQ3JCLElBQUksQ0FBQyxVQUFTLFVBQVU7WUFDdkIsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztpQkFDMUIsS0FBSyxDQUFDLDZDQUE2QyxDQUFDO2lCQUNwRCxJQUFJLENBQUMsVUFBUyxnQkFBZ0I7Z0JBQzdCLElBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7cUJBQzFCLEtBQUssQ0FBQyxrREFBa0QsQ0FBQztxQkFDekQsSUFBSSxDQUFDLFVBQVMsY0FBYztvQkFDM0IsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQzt5QkFDMUIsS0FBSyxDQUFDLGlDQUFpQyxDQUFDO3lCQUN4QyxJQUFJLENBQUMsVUFBUyxXQUFXO3dCQUN4QixJQUFJLEdB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QUssQ0FBQyxVQUFTLEdBQUc7NEJBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0RBQWtELEdBQUcsR0FBRyxDQUFDLENBQUM7d0JBQ3hFLENBQUMsQ0FBQyxDQUFDO29CQUNMLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEdBQUc7d0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMseUNBQXlDLEdBQUcsR0FBRyxDQUFDLENBQUM7b0JBQy9ELENBQUMsQ0FBQyxDQUFDO2dCQUNMLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEdBQUc7b0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEdBQUcsR0FBRyxDQUFDLENBQUM7Z0JBQzVDLENBQUMsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsR0FBRztnQkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsR0FBRyxHQUFHLENBQUMsQ0FBQztZQUMzQyxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEdBQUc7WUFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuQixDQUFDLENBQUMsQ0FBQztLQUNKO0lBQ0QsT0FBTyxHQUFHLEVBQUU7UUFDVixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQ2xCO0FBRUgsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoic2VydmljZXMvU2NoZWR1bGVTZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2NoZWR1bGUgPSByZXF1aXJlKCdub2RlLXNjaGVkdWxlJyk7XHJcbmNvbnN0IE1haWxTZXJ2aWNlID0gcmVxdWlyZShcIi4vTWFpbFNlcnZpY2VcIik7XHJcbmNvbnN0IEFjdGl2aXR5U2VydmljZSA9IHJlcXVpcmUoXCIuL0FjdGl2aXR5U2VydmljZVwiKTtcclxudmFyIHNxbCA9IHJlcXVpcmUoJ21zc3FsJyk7XHJcbnZhciBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcnKTtcclxuXHJcbi8vcnVucyBldmVyeSBuaWdodCBhdCA3OjMwcG1cclxudmFyIGF0dGVuZGFuY2VDaGVjayA9IHNjaGVkdWxlLnNjaGVkdWxlSm9iKCcwIDM2IDE2ICogKiAqJywgZnVuY3Rpb24oKSB7XHJcbnZhciBkYXRlID0gbmV3IERhdGUoKTtcclxudmFyIHR3b01pc3NlZENsYXNzZXMgPSAwLCBmb3VyTWlzc2VkQ2xhc3NlcyA9IDA7XHJcbnZhciBzdHVkZW50O1xyXG5cclxudHJ5IHtcclxuICBzcWwuY29ubmVjdChjb25maWcuZGIpXHJcbiAgLnRoZW4oZnVuY3Rpb24oY29ubmVjdGlvbikge1xyXG4gICAgbmV3IHNxbC5SZXF1ZXN0KGNvbm5lY3Rpb24pXHJcbiAgICAucXVlcnkoXCJTRUxFQ1QgKiBGUk9NIEF0dGVuZGFuY2UgT1JERVIgQlkgZGF0ZSBERVNDXCIpXHJcbiAgICAudGhlbihmdW5jdGlvbihhdHRlbmRhbmNlUmVzdWx0KSB7XHJcbiAgICAgIG5ldyBzcWwuUmVxdWVzdChjb25uZWN0aW9uKVxyXG4gICAgICAucXVlcnkoXCJTRUxFQ1QgdXNlcklELCBmaXJzdE5hbWUsIGxhc3ROYW1lIEZST00gU3R1ZGVudHNcIilcclxuICAgICAgLnRoZW4oZnVuY3Rpb24oc3R1ZGVudHNSZXN1bHQpIHtcclxuICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAucXVlcnkoXCJTRUxFQ1QgdXNlcklELCBlbWFpbCBGUk9NIFVzZXJzXCIpXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24odXNlcnNSZXN1bHQpIHtcclxuICAgICAgICAgIG5ldyBzcWwuUmVxdWVzdChjb25uZWN0aW9uKVxyXG4gICAgICAgICAgLnF1ZXJ5KFwiU0VMRUNUIGNvdXJzZUlELCBjb3Vyc2VOYW1lIEZST00gQ291cnNlXCIpXHJcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihjb3Vyc2VzUmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHN0dWRlbnQgb2Ygc3R1ZGVudHNSZXN1bHQpIHtcclxuICAgICAgICAgICAgICB2YXIgdXNlckluZm8gPSB1c2Vyc1Jlc3VsdC5maWx0ZXIoeCA9PiB4LnVzZXJJRCA9PT0gc3R1ZGVudC51c2VySUQpO1xyXG4gICAgICAgICAgICAgIHZhciBzdHVkZW50QXR0ZW5kYW5jZSA9IGF0dGVuZGFuY2VSZXN1bHQuZmlsdGVyKHggPT4geC51c2VySUQgPT09IHN0dWRlbnQudXNlcklEKTtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIiMgb2YgYXR0ZW5kYW5jZSByZWNvcmRzIGZvciBcIiArIHN0dWRlbnQuZmlyc3ROYW1lICsgXCI6IFwiICsgc3R1ZGVudEF0dGVuZGFuY2UubGVuZ3RoKTtcclxuICAgICAgICAgICAgICBmdW5jdGlvbiBjb3Vyc2VCeShhcnJheSwgZikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvdXJzZXMgPSB7fTtcclxuICAgICAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24obykge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgY291cnNlID0gSlNPTi5zdHJpbmdpZnkoZihvKSk7XHJcbiAgICAgICAgICAgICAgICAgIGNvdXJzZXNbY291cnNlXSA9IGNvdXJzZXNbY291cnNlXSB8fCBbXTtcclxuICAgICAgICAgICAgICAgICAgY291cnNlc1tjb3Vyc2VdLnB1c2gobyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhjb3Vyc2VzKS5tYXAoZnVuY3Rpb24oY291cnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiBjb3Vyc2VzW2NvdXJzZV07XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gY291cnNlQnkoc3R1ZGVudEF0dGVuZGFuY2UsIGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbaXRlbS5jb3Vyc2VJRCwgaXRlbS51c2VySURdO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIGZvciAobGV0IGNvdXJzZSBvZiByZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291cnNlLmxlbmd0aCAtIDE7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgYXZhaWxhYmxlQ291cnNlcyA9IGNvdXJzZS5maWx0ZXIoeCA9PiB4LmZvdXJNaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICBpZiAoYXZhaWxhYmxlQ291cnNlcy5sZW5ndGggPj0gNCAmJiBjb3Vyc2VbaSArIDFdICE9IG51bGwgJiYgY291cnNlW2kgKyAyXSAhPSBudWxsICYmIGNvdXJzZVtpICsgM10gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb3Vyc2VbaV0uZm91ck1pc3NlZENsYXNzTXNnID09PSBmYWxzZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPT09IGZhbHNlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDJdLmZvdXJNaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UgJiZcclxuICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgM10uZm91ck1pc3NlZENsYXNzTXNnID09PSBmYWxzZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgY291cnNlW2ldLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDFdLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDJdLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDNdLmF0dGVuZGFuY2VWYWx1ZSA9PT0gJ0EnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vbWFyayBhdHRlbmRhbmNlIHJlY29yZHMgYXMgcmV2aWV3ZWQgYW5kIG1lc3NhZ2Ugc2VudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaV0uZm91ck1pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS5mb3VyTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDJdLmZvdXJNaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgM10uZm91ck1pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2ldLnR3b01pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS50d29NaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMl0udHdvTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VbaSArIDNdLnR3b01pc3NlZENsYXNzTXNnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdXJzZUluZm8gPSBjb3Vyc2VzUmVzdWx0LmZpbHRlcih4ID0+IHguY291cnNlSUQgPT09IGNvdXJzZVtpXS5jb3Vyc2VJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZvdXIgY29uc2VjdXRpdmUgY2xhc3NlcyBtaXNzZWQgYnk6IFwiICsgc3R1ZGVudC5maXJzdE5hbWUgKyBcIiBcIiArIHN0dWRlbnQubGFzdE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN0dWRlbnQgSUQ6IFwiICsgY291cnNlW2ldLnVzZXJJRCArIFwiIC0gXCIgKyBjb3Vyc2VbaSArIDFdLnVzZXJJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZXM6IFwiICsgY291cnNlW2ldLmRhdGUgKyAnICYgJyArIGNvdXJzZVtpICsgMV0uZGF0ZSArICcgJiAnICsgY291cnNlW2kgKyAyXS5kYXRlICsgJyAmICcgKyBjb3Vyc2VbaSArIDNdLmRhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvdXJzZSBJRDogXCIgKyBjb3Vyc2VbaV0uY291cnNlSUQgKyBcIiAtIFwiICsgY291cnNlW2kgKyAxXS5jb3Vyc2VJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRW1haWw6IFwiICsgdXNlckluZm9bMF0uZW1haWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm91ck1pc3NlZENsYXNzZXMgKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1haWxPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IGNvbmZpZy5tYWlsLnVzZXIsIC8vIHNlbmRlciBhZGRyZXNzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdG86IHVzZXJJbmZvWzBdLmVtYWlsLCAvLyBsaXN0IG9mIHJlY2VpdmVyc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3Q6ICdSZW1vdmFsIGZyb20gJyArIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSwgLy8gU3ViamVjdCBsaW5lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJycsIC8vIHBsYWluIHRleHQgYm9keVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWw6ICdIaSAnICsgc3R1ZGVudC5maXJzdE5hbWUgKyAnLDxiciAvPjxiciAvPk91ciByZWNvcmRzIGluZGljYXRlIHRoYXQgeW91IGhhdmUgbWlzc2VkIDUwJSBvciBtb3JlIG9mIHlvdXIgJyArIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJyBjbGFzc2VzIGluIHRoZSBsYXN0IGZvdXIgd2Vla3MuIE91ciBwb2xpY3kgc3RhdGVzIHRoYXQgc3R1ZGVudHMgd2lsbCBiZSB3aXRoZHJhd24gd2hlbiB0aGlzIG11Y2ggdGltZSBoYXMgYmVlbiBtaXNzZWQuIFVuZm9ydHVuYXRlbHksICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICd0aGlzIG1lYW5zIHRoYXQgeW91IGFyZSBiZWluZyBleGl0ZWQgZnJvbSAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lICsgJyBjbGFzcy48YnIgLz48YnIgLz5QbGVhc2UgY29udGFjdCBtZSBieSBwaG9uZSBhdCA3MDUtNzI4LTE5NjgsIEV4dC4gWFhYWCBvciBieSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAnZW1haWwgYXQgPGE+Q2hlcnlsLkJveWVzQEdlb3JnaWFuQ29sbGVnZS5jYTwvYT4gdG8gY29tcGxldGUgdGhlIG5lY2Vzc2FyeSBwYXBlcndvcmsgYW5kIGRpc2N1c3MgcG9zc2libGUgb3Bwb3J0dW5pdGllcyBmb3IgcmV0dXJuaW5nIHRvIHRoZSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vyc2VJbmZvWzBdLmNvdXJzZU5hbWUgKyAnIGNsYXNzIGF0IGEgbGF0ZXIgZGF0ZS48YnIgLz48YnIgLz5SZWdhcmRzLDxiciAvPjxiciAvPjxzdHJvbmc+Q2hlcnlsIEJveWVzPC9zdHJvbmc+PGJyIC8+PHN0cm9uZz5BY2FkZW1pYyBVcGdyYWRpbmcgT2ZmaWNlcjwvc3Ryb25nPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICc8YnIgLz5HZW9yZ2lhbiBDb2xsZWdlfCBPbmUgR2VvcmdpYW4gRHJpdmUgfCBCYXJyaWUgT04gfCBMNE0gM1g5JyAvLyBodG1sIGJvZHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCJVUERBVEUgQXR0ZW5kYW5jZSBTRVQgZm91ck1pc3NlZENsYXNzTXNnID0gJ3RydWUnLCB0d29NaXNzZWRDbGFzc01zZyA9ICd0cnVlJyBXSEVSRSBhdHRlbmRhbmNlSUQgSU5cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiICgnXCIgKyBjb3Vyc2VbaV0uYXR0ZW5kYW5jZUlEICsgXCInLCdcIiArIGNvdXJzZVtpICsgMV0uYXR0ZW5kYW5jZUlEICsgXCInLCdcIiArIGNvdXJzZVtpICsgMl0uYXR0ZW5kYW5jZUlEICsgXCInLCdcIiArIGNvdXJzZVtpICsgM10uYXR0ZW5kYW5jZUlEICsgXCInKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5KHF1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFpbFNlcnZpY2UoKS5zZW5kTWVzc2FnZSgnRm91ciBNaXNzZWQgQ2xhc3NlcycsIG1haWxPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQWN0aXZpdHlTZXJ2aWNlKCkucmVwb3J0QWN0aXZpdHkoJ3NjaGVkdWxlZEVtYWlscycsICdGb3VyIE1pc3NlZCBDbGFzc2VzJywgJ3N1Y2Nlc3MnLCBzdHVkZW50LnVzZXJJRCwgJycsIHN0dWRlbnQuZmlyc3ROYW1lICsgJyAnICsgc3R1ZGVudC5sYXN0TmFtZSArICcgaGFzIG1pc3NlZCBmb3VyIGNvbnNlY3V0aXZlIGNsYXNzZXMgZm9yIHRoZSBmb2xsb3dpbmcgY291cnNlOiAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVcGRhdGUgYXR0ZW5kYW5jZSByZWNvcmRzOiBcIiArIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoY291cnNlLmxlbmd0aCA+PSAyICYmIGNvdXJzZVtpICsgMV0gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdXJzZVtpXS5hdHRlbmRhbmNlVmFsdWUgPT09ICdBJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS5hdHRlbmRhbmNlVmFsdWUgPT09ICdBJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgY291cnNlW2ldLnR3b01pc3NlZENsYXNzTXNnID09PSBmYWxzZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgY291cnNlW2kgKyAxXS50d29NaXNzZWRDbGFzc01zZyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9tYXJrIGF0dGVuZGFuY2UgcmVjb3JkcyBhcyByZXZpZXdlZCBhbmQgbWVzc2FnZSBzZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpXS50d29NaXNzZWRDbGFzc01zZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdXJzZVtpICsgMV0udHdvTWlzc2VkQ2xhc3NNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291cnNlSW5mbyA9IGNvdXJzZXNSZXN1bHQuZmlsdGVyKHggPT4geC5jb3Vyc2VJRCA9PT0gY291cnNlW2ldLmNvdXJzZUlEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHdvIGNvbnNlY3V0aXZlIGNsYXNzZXMgaGF2ZSBiZWVuIG1pc3NlZCBieTogXCIgKyBzdHVkZW50LmZpcnN0TmFtZSArIFwiIFwiICsgc3R1ZGVudC5sYXN0TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3R1ZGVudCBJRDogXCIgKyBzdHVkZW50LnVzZXJJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZXM6IFwiICsgY291cnNlW2ldLmRhdGUgKyAnICYgJyArIGNvdXJzZVtpICsgMV0uZGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ291cnNlIElEOiBcIiArIGNvdXJzZVtpXS5jb3Vyc2VJRCArIFwiIC0gXCIgKyBjb3Vyc2VbaSArIDFdLmNvdXJzZUlEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFbWFpbDogXCIgKyB1c2VySW5mb1swXS5lbWFpbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0d29NaXNzZWRDbGFzc2VzICs9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYWlsT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBjb25maWcubWFpbC51c2VyLCAvLyBzZW5kZXIgYWRkcmVzc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRvOiB1c2VySW5mb1swXS5lbWFpbCwgLy8gc3R1ZGVudC5lbWFpbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3Q6ICdUd28gTWlzc2VkICcgKyBjb3Vyc2VJbmZvWzBdLmNvdXJzZU5hbWUgKyAnIENsYXNzZXMnLCAvLyBTdWJqZWN0IGxpbmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnJywgLy8gcGxhaW4gdGV4dCBib2R5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbDogJ0hpICcgKyBzdHVkZW50LmZpcnN0TmFtZSArICcsPGJyIC8+PGJyIC8+SSBub3RpY2VkIHRoYXQgeW91IG1pc3NlZCB0aGUgbGFzdCB0d28gY29uc2VjdXRpdmUgJyArIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArICcgY2xhc3Nlcy4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAnIEkgaG9wZSBldmVyeXRoaW5nIGlzIG9rYXkuIExldCBtZSBrbm93IGlmIHRoZXJlIGlzIHNvbWV0aGluZyBJIGNhbiBkbyB0byBoZWxwLjxiciAvPjxiciAvPlBsZWFzZSBiZSByZW1pbmRlZCBvZiBvdXIgcHJvZ3JhbSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAncG9saWN5IHRoYXQgc3RhdGVzIHN0dWRlbnRzIGFyZSByZXNwb25zaWJsZSB0byBub3RpZnkgdGhlaXIgaW5zdHJ1Y3RvcnMgd2hlbiB0aGV5IHdpbGwgYmUgYWJzZW50LiBJbiBhZGRpdGlvbiwgdGhlIHBvbGljeSBkaXJlY3RzICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdzdHVkZW50cyB0byBhcnJhbmdlIGZvciBhIGxlYXZlIG9mIGFic2VuY2UgaWYgdGhleSBuZWVkIHRvIG1pc3MgdHdvIG9yIG1vcmUgY2xhc3NlcyBpbiBhIHJvdy4gQSBsZWF2ZSBvZiBhYnNlbmNlIGNhbiBiZSBhcnJhbmdlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdDaGVyeWwgQm95ZXMsIHdobyBjYW4gY29udGFjdGVkIGJ5IHBob25lIGF0IDcwNS03MjgtMTk2OCwgRXh0LiBYWFhYIG9yIGJ5IGVtYWlsIGF0IDxhPkNoZXJ5bC5Cb3llc0BHZW9yZ2lhbkNvbGxlZ2UuY2E8L2E+PGJyIC8+PGJyIC8+UGxlYXNlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdnZXQgaW4gdG91Y2ggd2l0aCBtZSBhcyBzb29uIGFzIHBvc3NpYmxlLiBVbmZvcnR1bmF0ZWx5LCBpZiBJIGRvbuKAmXQgaGVhciBmcm9tIHlvdSwgYW5kIHlvdSBtaXNzIHRoZSBuZXh0IHR3byBjbGFzc2VzLCB5b3UgcmlzayBiZWluZyB3aXRoZHJhd24gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Zyb20gJyArIGNvdXJzZUluZm9bMF0uY291cnNlTmFtZSArICcuPGJyIC8+PGJyIC8+QmVzdCBSZWdhcmRzLDxiciAvPjxiciAvPjxzdHJvbmc+Sm9hbm5lIFBpbmVkYSwgTUEgQWRFZDwvc3Ryb25nPjxiciAvPjxzdHJvbmc+QWNhZGVtaWMgUHJlcGFyYXRpb24gRmFjdWx0eScgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICc8L3N0cm9uZz48YnIgLz48YnIgLz5HZW9yZ2lhbiBDb2xsZWdlfCBPbmUgR2VvcmdpYW4gRHJpdmUgfCBCYXJyaWUgT04gfCBMNE0gM1g5JyAvLyBodG1sIGJvZHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCJVUERBVEUgQXR0ZW5kYW5jZSBTRVQgdHdvTWlzc2VkQ2xhc3NNc2cgPSAndHJ1ZScgV0hFUkUgYXR0ZW5kYW5jZUlEIElOICgnXCIgKyBjb3Vyc2VbaV0uYXR0ZW5kYW5jZUlEICsgXCInLCdcIiArIGNvdXJzZVtpICsgMV0uYXR0ZW5kYW5jZUlEICsgXCInKVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgc3FsLlJlcXVlc3QoY29ubmVjdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5KHF1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFpbFNlcnZpY2UoKS5zZW5kTWVzc2FnZSgnVHdvIE1pc3NlZCBDbGFzc2VzJywgbWFpbE9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBBY3Rpdml0eVNlcnZpY2UoKS5yZXBvcnRBY3Rpdml0eSgnc2NoZWR1bGVkRW1haWxzJywgJ1R3byBNaXNzZWQgQ2xhc3NlcycsICdzdWNjZXNzJywgc3R1ZGVudC51c2VySUQsICcnLCBzdHVkZW50LmZpcnN0TmFtZSArICcgJyArIHN0dWRlbnQubGFzdE5hbWUgKyAnIGhhcyBtaXNzZWQgdHdvIGNvbnNlY3V0aXZlIGNsYXNzZXMgZm9yIHRoZSBmb2xsb3dpbmcgY291cnNlOiAnICsgY291cnNlSW5mb1swXS5jb3Vyc2VOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3QgdXNlcklEIGFuZCBlbWFpbCBmcm9tIGFsbCB1c2VycyBcIiArIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBsZXQgbWFpbE9wdGlvbnNBZG1pbiA9IHtcclxuICAgICAgICAgICAgICAgIGZyb206ICdhY2FkZW1pYy5jYXJlZXIucHJlcEBnbWFpbC5jb20nLCAvLyBzZW5kZXIgYWRkcmVzc1xyXG4gICAgICAgICAgICAgICAgdG86ICdhY2FkZW1pYy5jYXJlZXIucHJlcEBnbWFpbC5jb20nLCAvLyBsaXN0IG9mIHJlY2VpdmVyc1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdDogJ1NDSEVEVUxFUiDinJQnLCAvLyBTdWJqZWN0IGxpbmVcclxuICAgICAgICAgICAgICAgIHRleHQ6ICcnLCAvLyBwbGFpbiB0ZXh0IGJvZHlcclxuICAgICAgICAgICAgICAgIGh0bWw6ICc8Yj4gSGkgYWRtaW4hPC9iPjxiciAgLz48YnIgIC8+VGhlcmUgd2VyZSA8c3Ryb25nPicgKyB0d29NaXNzZWRDbGFzc2VzICsgJzwvc3Ryb25nPiBlbWFpbHMgc2VudCBvdXQgZHVlIHRvIG1pc3NlZCBjbGFzc2VzIHRvZGF5LiA8YnIvPiBUaGVyZSB3ZXJlIDxzdHJvbmc+JyArXHJcbiAgICAgICAgICAgICAgICBmb3VyTWlzc2VkQ2xhc3NlcyArICc8L3N0cm9uZz4gcmVtb3ZhbHMgZnJvbSBhIGNvdXJzZSB0b2RheS4nIC8vIGh0bWwgYm9keVxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgbmV3IE1haWxTZXJ2aWNlKCkuc2VuZE1lc3NhZ2UoXCJTY2hlZHVsZWQgTWVzc2FnZVwiLCBtYWlsT3B0aW9uc0FkbWluKTtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRPVEFMIFdBUk5JTkcgRU1BSUxTIFNFTlQ6IFwiICsgdHdvTWlzc2VkQ2xhc3Nlcyk7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUT1RBTCBSRU1PVkFMIEVNQUlMUyBTRU5UOiBcIiArIGZvdXJNaXNzZWRDbGFzc2VzKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3QgY291cnNlSUQgYW5kIGNvdXJzZU5hbWUgZnJvbSBhbGwgY291cnNlcyBcIiArIGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2VsZWN0IHVzZXJJRCBhbmQgZW1haWwgZnJvbSBhbGwgdXNlcnMgXCIgKyBlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbGVjdCBhbGwgc3R1ZGVudHMgXCIgKyBlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkdldCBhbGwgYXR0ZW5kYW5jZSBcIiArIGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9XHJcblxyXG59KTtcclxuIl19
